[2024-06-19 18:41:50,158][flwr][INFO] - Starting Flower simulation, config: num_rounds=10, no round_timeout
[2024-06-19 18:41:53,693][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 8331580212.0, 'CPU': 12.0, 'node:__internal_head__': 1.0, 'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0}
[2024-06-19 18:41:53,694][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-06-19 18:41:53,694][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 2, 'num_gpus': 0}
[2024-06-19 18:41:53,710][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 6 actors
[2024-06-19 18:41:53,710][flwr][INFO] - [INIT]
[2024-06-19 18:41:53,710][flwr][INFO] - Requesting initial parameters from one random client
[2024-06-19 18:41:56,627][flwr][INFO] - Received initial parameters from one random client
[2024-06-19 18:41:56,628][flwr][INFO] - Evaluating initial global parameters
[2024-06-19 18:41:57,122][flwr][INFO] - initial parameters (loss, other metrics): 181.76928067207336, {'accuracy': 0.1086, 'precision': 0.12349967530374152, 'recall': 0.1086, 'f1': 0.03553137346181725, 'confusion_matrix': array([[   0,    8,    0,  956,    0,    1,    0,   15,    0,    0],
       [   0,  122,    0, 1013,    0,    0,    0,    0,    0,    0],
       [   0,   38,    0,  971,    0,    0,    3,   19,    1,    0],
       [   0,   44,    0,  945,    1,    1,    0,   17,    2,    0],
       [   0,  143,    0,  816,    1,    0,    2,   20,    0,    0],
       [   0,  118,    0,  735,    1,    7,    0,   30,    1,    0],
       [   0,  144,    0,  749,   25,    0,    2,   38,    0,    0],
       [   0,  272,    0,  724,    8,    0,    0,    9,   15,    0],
       [   0,   81,    0,  859,    1,    0,    1,   32,    0,    0],
       [   0,  178,    0,  799,    1,    0,    0,   31,    0,    0]])}
[2024-06-19 18:41:57,123][flwr][INFO] - 
[2024-06-19 18:41:57,123][flwr][INFO] - [ROUND 1]
[2024-06-19 18:41:57,124][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:01,005][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:01,037][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:04,125][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:04,127][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:04,250][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:04,268][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:04,280][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:04,284][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:04,284][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:04,284][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:06,302][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:06,309][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-06-19 18:42:06,749][flwr][INFO] - fit progress: (1, 79.10789674520493, {'accuracy': 0.6879, 'precision': 0.7641582878698121, 'recall': 0.6879, 'f1': 0.6661969422706358, 'confusion_matrix': array([[807,   0,  75,   2,   0,   0,  79,  14,   0,   3],
       [  0, 953, 121,   2,   0,   0,   5,  10,   2,  42],
       [  7,   2, 938,   4,  12,   0,  30,  25,   6,   8],
       [  6,   0, 231, 639,   2,   2,   2,  72,   9,  47],
       [  0,   0,  16,   0, 532,   0,  31,   5,   0, 398],
       [ 36,   4, 190, 191,  69,  99,  57, 108,  46,  92],
       [  6,   1,  40,   0,  14,   0, 894,   0,   0,   3],
       [  0,   2,  35,   1,   7,   0,   0, 946,   0,  37],
       [ 12,   0, 366,  34,  10,   0,  10,  64, 291, 187],
       [  7,   2,  11,   3,  15,   0,   2, 188,   1, 780]])}, 9.626109833999998)
[2024-06-19 18:42:06,749][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:06,750][flwr][INFO] - 
[2024-06-19 18:42:06,750][flwr][INFO] - [ROUND 2]
[2024-06-19 18:42:06,750][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:10,534][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:10,536][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:10,572][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:10,586][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:10,619][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:10,621][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:10,622][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:10,622][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:10,623][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:10,623][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:12,941][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:13,402][flwr][INFO] - fit progress: (2, 34.14752536267042, {'accuracy': 0.8793, 'precision': 0.8792010174474466, 'recall': 0.8793, 'f1': 0.8785153349919584, 'confusion_matrix': array([[ 922,    0,    3,    5,    0,   20,   19,    2,    9,    0],
       [   0, 1116,    7,    2,    0,    1,    3,    0,    6,    0],
       [  11,   13,  898,   17,   19,    0,   19,   14,   33,    8],
       [   8,   12,   35,  863,    1,   32,    2,   22,   25,   10],
       [   0,    7,    9,    0,  876,    1,   14,    0,    2,   73],
       [  21,   16,   15,   61,   23,  676,   12,   12,   40,   16],
       [  13,   13,   15,    0,   14,   22,  877,    1,    3,    0],
       [   2,   25,   26,    0,    8,    0,    0,  906,    5,   56],
       [   7,   31,   20,   37,   16,   37,    4,   11,  768,   43],
       [   9,    6,    5,    4,   41,    7,    1,   32,   13,  891]])}, 16.279412417)
[2024-06-19 18:42:13,403][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:13,403][flwr][INFO] - 
[2024-06-19 18:42:13,403][flwr][INFO] - [ROUND 3]
[2024-06-19 18:42:13,403][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:16,644][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:16,645][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:16,658][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:16,661][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:16,746][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:16,764][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:16,785][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:16,801][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:16,842][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:16,842][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:19,581][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:20,025][flwr][INFO] - fit progress: (3, 29.099306270480156, {'accuracy': 0.8939, 'precision': 0.8962239377867145, 'recall': 0.8939, 'f1': 0.8939352857151817, 'confusion_matrix': array([[ 954,    0,    0,    1,    0,   13,   11,    1,    0,    0],
       [   0, 1094,    2,    5,    1,    5,    4,    1,   23,    0],
       [  17,    4,  840,   21,   23,    4,   27,   17,   65,   14],
       [   4,    1,   16,  848,    1,   63,    6,   16,   41,   14],
       [   1,    1,    2,    0,  890,    2,   14,    0,    3,   69],
       [  14,    3,    4,   34,   16,  776,   14,    8,   14,    9],
       [  12,    4,    3,    0,   18,   21,  897,    1,    2,    0],
       [   1,   12,   14,    3,    9,    0,    0,  914,    9,   66],
       [  11,    5,    7,   15,   12,   53,   15,    5,  810,   41],
       [  12,    5,    2,    5,   34,   13,    1,   15,    6,  916]])}, 22.902384625)
[2024-06-19 18:42:20,026][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:20,026][flwr][INFO] - 
[2024-06-19 18:42:20,026][flwr][INFO] - [ROUND 4]
[2024-06-19 18:42:20,026][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:23,468][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:23,488][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:23,519][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:23,533][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:23,548][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:23,548][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:23,549][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:23,551][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:23,611][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:23,612][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:25,855][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:26,326][flwr][INFO] - fit progress: (4, 25.53866382688284, {'accuracy': 0.9096, 'precision': 0.9098321717671782, 'recall': 0.9096, 'f1': 0.9094436920242988, 'confusion_matrix': array([[ 949,    0,    6,    3,    0,    9,   11,    1,    1,    0],
       [   0, 1108,    3,    2,    0,    2,    4,    0,   16,    0],
       [  10,    6,  923,   20,   10,    0,   13,   14,   32,    4],
       [   3,    2,   24,  911,    0,   21,    3,   19,   24,    3],
       [   2,    7,    6,    0,  852,    1,   20,    0,   12,   82],
       [   8,    3,    9,   44,    4,  777,   12,    5,   21,    9],
       [  10,    5,    9,    1,    7,   19,  902,    1,    4,    0],
       [   1,   19,   26,    2,    5,    0,    0,  932,    4,   39],
       [   9,    9,   11,   23,   10,   42,   12,   11,  829,   18],
       [  10,    7,    6,    8,   20,   11,    0,   22,   12,  913]])}, 29.202977959)
[2024-06-19 18:42:26,326][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:26,326][flwr][INFO] - 
[2024-06-19 18:42:26,326][flwr][INFO] - [ROUND 5]
[2024-06-19 18:42:26,327][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:30,223][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:30,225][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:30,235][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:30,246][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:30,263][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:30,277][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:30,293][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:30,294][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:30,295][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:30,295][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:32,557][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:33,013][flwr][INFO] - fit progress: (5, 22.312309939414263, {'accuracy': 0.9169, 'precision': 0.9181603240389034, 'recall': 0.9169, 'f1': 0.9168698705681276, 'confusion_matrix': array([[ 958,    0,    3,    2,    0,    5,    7,    1,    4,    0],
       [   0, 1110,    1,    3,    1,    0,    4,    1,   15,    0],
       [  11,    7,  914,   19,   17,    0,   15,    9,   36,    4],
       [   4,    3,   13,  895,    1,   23,    3,   18,   42,    8],
       [   1,    3,    4,    0,  890,    0,   14,    0,    5,   65],
       [  13,    4,    3,   29,   11,  769,   12,    7,   35,    9],
       [  19,    5,    6,    0,   11,   12,  900,    0,    5,    0],
       [   2,   23,   26,    3,    6,    0,    0,  914,    2,   52],
       [   4,    8,    2,   13,   10,   12,    7,    5,  899,   14],
       [  13,    6,    1,    6,   34,    2,    1,    8,   18,  920]])}, 35.889950541999994)
[2024-06-19 18:42:33,013][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:33,013][flwr][INFO] - 
[2024-06-19 18:42:33,013][flwr][INFO] - [ROUND 6]
[2024-06-19 18:42:33,014][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:36,027][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:36,031][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:36,100][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:36,101][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:36,130][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:36,131][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:36,155][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:36,156][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:36,177][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:36,178][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:38,447][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:38,886][flwr][INFO] - fit progress: (6, 20.806171000003815, {'accuracy': 0.9201, 'precision': 0.921087405535254, 'recall': 0.9201, 'f1': 0.9201077309955484, 'confusion_matrix': array([[ 951,    0,    4,    4,    0,    9,    8,    1,    3,    0],
       [   0, 1119,    2,    3,    1,    0,    3,    1,    5,    1],
       [   9,   11,  934,   24,   12,    1,    7,   15,   15,    4],
       [   3,    3,   15,  929,    0,   13,    3,   19,   13,   12],
       [   2,    4,    6,    0,  883,    0,    9,    0,    3,   75],
       [   8,    4,    5,   40,   13,  770,    7,    7,   22,   16],
       [  11,    5,    7,    0,   18,   22,  888,    1,    6,    0],
       [   1,   14,   23,    8,    5,    0,    0,  929,    0,   48],
       [   4,   10,    5,   23,   17,   18,    6,    6,  860,   25],
       [   5,    6,    1,   10,   26,    8,    1,    8,    6,  938]])}, 41.763231209)
[2024-06-19 18:42:38,886][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:38,887][flwr][INFO] - 
[2024-06-19 18:42:38,887][flwr][INFO] - [ROUND 7]
[2024-06-19 18:42:38,887][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:42,913][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:42,930][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:42,952][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:42,952][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:42,972][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:42,973][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:42,984][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:42,985][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:42,985][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:42,986][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:45,238][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:45,696][flwr][INFO] - fit progress: (7, 20.36982693336904, {'accuracy': 0.9252, 'precision': 0.9256649982013693, 'recall': 0.9252, 'f1': 0.9249562057184767, 'confusion_matrix': array([[ 969,    0,    0,    2,    0,    3,    5,    1,    0,    0],
       [   0, 1117,    1,    3,    0,    1,    4,    1,    8,    0],
       [  19,    5,  924,   27,   11,    1,   10,   13,   18,    4],
       [   4,    1,   12,  936,    0,   28,    2,   14,    7,    6],
       [   3,    5,    4,    0,  913,    1,   17,    1,    7,   31],
       [  14,    1,    0,   24,    4,  815,   10,    5,   16,    3],
       [  20,    5,    2,    0,    8,   25,  895,    1,    2,    0],
       [   4,   11,   30,   10,    4,    1,    0,  943,    0,   25],
       [  15,   11,    4,   30,   12,   37,    8,    6,  833,   18],
       [  13,    7,    0,   11,   40,   14,    2,   12,    3,  907]])}, 48.573536042)
[2024-06-19 18:42:45,697][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:45,697][flwr][INFO] - 
[2024-06-19 18:42:45,697][flwr][INFO] - [ROUND 8]
[2024-06-19 18:42:45,697][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:48,917][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:48,920][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:48,929][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:48,930][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:48,991][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:48,992][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:48,992][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:48,993][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:48,998][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:48,999][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:51,220][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:51,663][flwr][INFO] - fit progress: (8, 19.401778507977724, {'accuracy': 0.9288, 'precision': 0.9293952242404614, 'recall': 0.9288, 'f1': 0.9286284704422479, 'confusion_matrix': array([[ 968,    0,    1,    2,    0,    2,    4,    1,    2,    0],
       [   0, 1116,    2,    3,    0,    0,    3,    1,   10,    0],
       [  15,    7,  918,   19,   10,    2,   11,   20,   29,    1],
       [   7,    3,   10,  914,    0,   46,    2,   12,   14,    2],
       [   1,    5,    4,    0,  927,    0,   11,    1,    8,   25],
       [  10,    3,    1,   13,    2,  831,    6,    2,   21,    3],
       [  22,    4,    2,    0,   11,   14,  892,    2,   11,    0],
       [   3,   18,   24,   11,    8,    0,    0,  943,    0,   21],
       [  17,    4,    2,   17,    5,   21,    3,    5,  890,   10],
       [  14,    7,    0,   10,   54,   14,    0,   10,   11,  889]])}, 54.53985291699999)
[2024-06-19 18:42:51,663][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:51,663][flwr][INFO] - 
[2024-06-19 18:42:51,663][flwr][INFO] - [ROUND 9]
[2024-06-19 18:42:51,663][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:42:54,781][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:54,788][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:54,856][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:54,857][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:54,917][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:54,918][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:54,919][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87558, ip=127.0.0.1, actor_id=1c63ac7fd23bb812253c2c7a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113d17b50>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:54,919][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:42:54,919][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:54,920][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:42:57,075][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:42:57,521][flwr][INFO] - fit progress: (9, 19.158218268305063, {'accuracy': 0.9275, 'precision': 0.9285931457039475, 'recall': 0.9275, 'f1': 0.9273914587405668, 'confusion_matrix': array([[ 971,    0,    1,    2,    0,    3,    0,    2,    1,    0],
       [   0, 1110,    4,    3,    1,    1,    5,    2,    9,    0],
       [  16,    2,  959,   15,    7,    0,    5,   16,   10,    2],
       [   4,    0,   16,  950,    0,    8,    1,   14,    8,    9],
       [   1,    2,    9,    0,  918,    0,   10,    2,    4,   36],
       [  15,    1,    2,   43,    6,  784,    7,    5,   20,    9],
       [  38,    3,    8,    1,   27,   11,  866,    1,    3,    0],
       [   2,    8,   28,    6,    4,    0,    0,  942,    0,   38],
       [  16,    3,    6,   33,   12,   15,    8,    7,  849,   25],
       [  14,    6,    1,   12,   37,    4,    0,    6,    3,  926]])}, 60.398728958999996)
[2024-06-19 18:42:57,522][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:42:57,522][flwr][INFO] - 
[2024-06-19 18:42:57,522][flwr][INFO] - [ROUND 10]
[2024-06-19 18:42:57,522][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:43:00,675][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:00,697][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87557, ip=127.0.0.1, actor_id=979b78db53779b7cbc13b63001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111312af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:00,802][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:00,818][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87556, ip=127.0.0.1, actor_id=8f7b5eb8eae110ba6ccd3c1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111c5fac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:00,836][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:00,852][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87559, ip=127.0.0.1, actor_id=3dd90dd2b71fd07bc69d522901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c1fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:00,871][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:00,873][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87560, ip=127.0.0.1, actor_id=754e6d02fb989aabfa8da6d301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114c03af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:00,877][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:00,878][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=87561, ip=127.0.0.1, actor_id=bd8f39542267627bf703b2ad01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10c7989d0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:03,032][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:43:03,481][flwr][INFO] - fit progress: (10, 17.8514619814232, {'accuracy': 0.9353, 'precision': 0.9355728576021455, 'recall': 0.9353, 'f1': 0.9351490311676305, 'confusion_matrix': array([[ 961,    0,    1,    0,    0,    2,   11,    1,    3,    1],
       [   0, 1116,    3,    2,    0,    0,    6,    1,    7,    0],
       [  11,    1,  966,    5,    7,    0,   14,   18,    8,    2],
       [   1,    3,   24,  921,    0,   21,    4,   15,   15,    6],
       [   2,    2,    4,    0,  904,    2,   26,    1,    4,   37],
       [   7,    1,    2,   22,    6,  818,   19,    1,   11,    5],
       [   8,    3,    2,    0,    8,    4,  932,    0,    1,    0],
       [   3,   12,   26,    1,    5,    1,    0,  947,    0,   33],
       [   9,    5,   13,   14,   10,   20,   15,    7,  867,   14],
       [  16,    6,    1,    6,   36,   11,    1,    5,    6,  921]])}, 66.35817725)
[2024-06-19 18:43:03,481][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:43:03,481][flwr][INFO] - 
[2024-06-19 18:43:03,481][flwr][INFO] - [SUMMARY]
[2024-06-19 18:43:03,482][flwr][INFO] - Run finished 10 round(s) in 66.36s
[2024-06-19 18:43:03,486][flwr][INFO] - 	History (loss, centralized):
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 0: 181.76928067207336
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 1: 79.10789674520493
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 2: 34.14752536267042
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 3: 29.099306270480156
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 4: 25.53866382688284
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 5: 22.312309939414263
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 6: 20.806171000003815
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 7: 20.36982693336904
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 8: 19.401778507977724
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 9: 19.158218268305063
[2024-06-19 18:43:03,487][flwr][INFO] - 		round 10: 17.8514619814232
[2024-06-19 18:43:03,487][flwr][INFO] - 	History (metrics, centralized):
[2024-06-19 18:43:03,487][flwr][INFO] - 	{'accuracy': [(0, 0.1086),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (1, 0.6879),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (2, 0.8793),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (3, 0.8939),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (4, 0.9096),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (5, 0.9169),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (6, 0.9201),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (7, 0.9252),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (8, 0.9288),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (9, 0.9275),
[2024-06-19 18:43:03,487][flwr][INFO] - 	              (10, 0.9353)],
[2024-06-19 18:43:03,487][flwr][INFO] - 	 'confusion_matrix': [(0,
[2024-06-19 18:43:03,487][flwr][INFO] - 	                       array([[   0,    8,    0,  956,    0,    1,    0,   15,    0,    0],
[2024-06-19 18:43:03,487][flwr][INFO] - 	       [   0,  122,    0, 1013,    0,    0,    0,    0,    0,    0],
[2024-06-19 18:43:03,487][flwr][INFO] - 	       [   0,   38,    0,  971,    0,    0,    3,   19,    1,    0],
[2024-06-19 18:43:03,487][flwr][INFO] - 	       [   0,   44,    0,  945,    1,    1,    0,   17,    2,    0],
[2024-06-19 18:43:03,487][flwr][INFO] - 	       [   0,  143,    0,  816,    1,    0,    2,   20,    0,    0],
[2024-06-19 18:43:03,487][flwr][INFO] - 	       [   0,  118,    0,  735,    1,    7,    0,   30,    1,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   0,  144,    0,  749,   25,    0,    2,   38,    0,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   0,  272,    0,  724,    8,    0,    0,    9,   15,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   0,   81,    0,  859,    1,    0,    1,   32,    0,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   0,  178,    0,  799,    1,    0,    0,   31,    0,    0]])),
[2024-06-19 18:43:03,488][flwr][INFO] - 	                      (1,
[2024-06-19 18:43:03,488][flwr][INFO] - 	                       array([[807,   0,  75,   2,   0,   0,  79,  14,   0,   3],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  0, 953, 121,   2,   0,   0,   5,  10,   2,  42],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  7,   2, 938,   4,  12,   0,  30,  25,   6,   8],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  6,   0, 231, 639,   2,   2,   2,  72,   9,  47],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  0,   0,  16,   0, 532,   0,  31,   5,   0, 398],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [ 36,   4, 190, 191,  69,  99,  57, 108,  46,  92],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  6,   1,  40,   0,  14,   0, 894,   0,   0,   3],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  0,   2,  35,   1,   7,   0,   0, 946,   0,  37],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [ 12,   0, 366,  34,  10,   0,  10,  64, 291, 187],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  7,   2,  11,   3,  15,   0,   2, 188,   1, 780]])),
[2024-06-19 18:43:03,488][flwr][INFO] - 	                      (2,
[2024-06-19 18:43:03,488][flwr][INFO] - 	                       array([[ 922,    0,    3,    5,    0,   20,   19,    2,    9,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   0, 1116,    7,    2,    0,    1,    3,    0,    6,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  11,   13,  898,   17,   19,    0,   19,   14,   33,    8],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   8,   12,   35,  863,    1,   32,    2,   22,   25,   10],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   0,    7,    9,    0,  876,    1,   14,    0,    2,   73],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  21,   16,   15,   61,   23,  676,   12,   12,   40,   16],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  13,   13,   15,    0,   14,   22,  877,    1,    3,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   2,   25,   26,    0,    8,    0,    0,  906,    5,   56],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   7,   31,   20,   37,   16,   37,    4,   11,  768,   43],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   9,    6,    5,    4,   41,    7,    1,   32,   13,  891]])),
[2024-06-19 18:43:03,488][flwr][INFO] - 	                      (3,
[2024-06-19 18:43:03,488][flwr][INFO] - 	                       array([[ 954,    0,    0,    1,    0,   13,   11,    1,    0,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   0, 1094,    2,    5,    1,    5,    4,    1,   23,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  17,    4,  840,   21,   23,    4,   27,   17,   65,   14],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   4,    1,   16,  848,    1,   63,    6,   16,   41,   14],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   1,    1,    2,    0,  890,    2,   14,    0,    3,   69],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  14,    3,    4,   34,   16,  776,   14,    8,   14,    9],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  12,    4,    3,    0,   18,   21,  897,    1,    2,    0],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [   1,   12,   14,    3,    9,    0,    0,  914,    9,   66],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  11,    5,    7,   15,   12,   53,   15,    5,  810,   41],
[2024-06-19 18:43:03,488][flwr][INFO] - 	       [  12,    5,    2,    5,   34,   13,    1,   15,    6,  916]])),
[2024-06-19 18:43:03,488][flwr][INFO] - 	                      (4,
[2024-06-19 18:43:03,489][flwr][INFO] - 	                       array([[ 949,    0,    6,    3,    0,    9,   11,    1,    1,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   0, 1108,    3,    2,    0,    2,    4,    0,   16,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  10,    6,  923,   20,   10,    0,   13,   14,   32,    4],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   3,    2,   24,  911,    0,   21,    3,   19,   24,    3],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   2,    7,    6,    0,  852,    1,   20,    0,   12,   82],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   8,    3,    9,   44,    4,  777,   12,    5,   21,    9],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  10,    5,    9,    1,    7,   19,  902,    1,    4,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   1,   19,   26,    2,    5,    0,    0,  932,    4,   39],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   9,    9,   11,   23,   10,   42,   12,   11,  829,   18],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  10,    7,    6,    8,   20,   11,    0,   22,   12,  913]])),
[2024-06-19 18:43:03,489][flwr][INFO] - 	                      (5,
[2024-06-19 18:43:03,489][flwr][INFO] - 	                       array([[ 958,    0,    3,    2,    0,    5,    7,    1,    4,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   0, 1110,    1,    3,    1,    0,    4,    1,   15,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  11,    7,  914,   19,   17,    0,   15,    9,   36,    4],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   4,    3,   13,  895,    1,   23,    3,   18,   42,    8],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   1,    3,    4,    0,  890,    0,   14,    0,    5,   65],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  13,    4,    3,   29,   11,  769,   12,    7,   35,    9],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  19,    5,    6,    0,   11,   12,  900,    0,    5,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   2,   23,   26,    3,    6,    0,    0,  914,    2,   52],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   4,    8,    2,   13,   10,   12,    7,    5,  899,   14],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  13,    6,    1,    6,   34,    2,    1,    8,   18,  920]])),
[2024-06-19 18:43:03,489][flwr][INFO] - 	                      (6,
[2024-06-19 18:43:03,489][flwr][INFO] - 	                       array([[ 951,    0,    4,    4,    0,    9,    8,    1,    3,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   0, 1119,    2,    3,    1,    0,    3,    1,    5,    1],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   9,   11,  934,   24,   12,    1,    7,   15,   15,    4],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   3,    3,   15,  929,    0,   13,    3,   19,   13,   12],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   2,    4,    6,    0,  883,    0,    9,    0,    3,   75],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   8,    4,    5,   40,   13,  770,    7,    7,   22,   16],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  11,    5,    7,    0,   18,   22,  888,    1,    6,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   1,   14,   23,    8,    5,    0,    0,  929,    0,   48],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   4,   10,    5,   23,   17,   18,    6,    6,  860,   25],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   5,    6,    1,   10,   26,    8,    1,    8,    6,  938]])),
[2024-06-19 18:43:03,489][flwr][INFO] - 	                      (7,
[2024-06-19 18:43:03,489][flwr][INFO] - 	                       array([[ 969,    0,    0,    2,    0,    3,    5,    1,    0,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   0, 1117,    1,    3,    0,    1,    4,    1,    8,    0],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [  19,    5,  924,   27,   11,    1,   10,   13,   18,    4],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   4,    1,   12,  936,    0,   28,    2,   14,    7,    6],
[2024-06-19 18:43:03,489][flwr][INFO] - 	       [   3,    5,    4,    0,  913,    1,   17,    1,    7,   31],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  14,    1,    0,   24,    4,  815,   10,    5,   16,    3],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  20,    5,    2,    0,    8,   25,  895,    1,    2,    0],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   4,   11,   30,   10,    4,    1,    0,  943,    0,   25],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  15,   11,    4,   30,   12,   37,    8,    6,  833,   18],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  13,    7,    0,   11,   40,   14,    2,   12,    3,  907]])),
[2024-06-19 18:43:03,490][flwr][INFO] - 	                      (8,
[2024-06-19 18:43:03,490][flwr][INFO] - 	                       array([[ 968,    0,    1,    2,    0,    2,    4,    1,    2,    0],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   0, 1116,    2,    3,    0,    0,    3,    1,   10,    0],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  15,    7,  918,   19,   10,    2,   11,   20,   29,    1],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   7,    3,   10,  914,    0,   46,    2,   12,   14,    2],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   1,    5,    4,    0,  927,    0,   11,    1,    8,   25],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  10,    3,    1,   13,    2,  831,    6,    2,   21,    3],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  22,    4,    2,    0,   11,   14,  892,    2,   11,    0],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   3,   18,   24,   11,    8,    0,    0,  943,    0,   21],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  17,    4,    2,   17,    5,   21,    3,    5,  890,   10],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  14,    7,    0,   10,   54,   14,    0,   10,   11,  889]])),
[2024-06-19 18:43:03,490][flwr][INFO] - 	                      (9,
[2024-06-19 18:43:03,490][flwr][INFO] - 	                       array([[ 971,    0,    1,    2,    0,    3,    0,    2,    1,    0],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   0, 1110,    4,    3,    1,    1,    5,    2,    9,    0],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  16,    2,  959,   15,    7,    0,    5,   16,   10,    2],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   4,    0,   16,  950,    0,    8,    1,   14,    8,    9],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   1,    2,    9,    0,  918,    0,   10,    2,    4,   36],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  15,    1,    2,   43,    6,  784,    7,    5,   20,    9],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  38,    3,    8,    1,   27,   11,  866,    1,    3,    0],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   2,    8,   28,    6,    4,    0,    0,  942,    0,   38],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  16,    3,    6,   33,   12,   15,    8,    7,  849,   25],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  14,    6,    1,   12,   37,    4,    0,    6,    3,  926]])),
[2024-06-19 18:43:03,490][flwr][INFO] - 	                      (10,
[2024-06-19 18:43:03,490][flwr][INFO] - 	                       array([[ 961,    0,    1,    0,    0,    2,   11,    1,    3,    1],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   0, 1116,    3,    2,    0,    0,    6,    1,    7,    0],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [  11,    1,  966,    5,    7,    0,   14,   18,    8,    2],
[2024-06-19 18:43:03,490][flwr][INFO] - 	       [   1,    3,   24,  921,    0,   21,    4,   15,   15,    6],
[2024-06-19 18:43:03,491][flwr][INFO] - 	       [   2,    2,    4,    0,  904,    2,   26,    1,    4,   37],
[2024-06-19 18:43:03,491][flwr][INFO] - 	       [   7,    1,    2,   22,    6,  818,   19,    1,   11,    5],
[2024-06-19 18:43:03,491][flwr][INFO] - 	       [   8,    3,    2,    0,    8,    4,  932,    0,    1,    0],
[2024-06-19 18:43:03,491][flwr][INFO] - 	       [   3,   12,   26,    1,    5,    1,    0,  947,    0,   33],
[2024-06-19 18:43:03,491][flwr][INFO] - 	       [   9,    5,   13,   14,   10,   20,   15,    7,  867,   14],
[2024-06-19 18:43:03,491][flwr][INFO] - 	       [  16,    6,    1,    6,   36,   11,    1,    5,    6,  921]]))],
[2024-06-19 18:43:03,491][flwr][INFO] - 	 'f1': [(0, 0.03553137346181725),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (1, 0.6661969422706358),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (2, 0.8785153349919584),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (3, 0.8939352857151817),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (4, 0.9094436920242988),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (5, 0.9168698705681276),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (6, 0.9201077309955484),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (7, 0.9249562057184767),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (8, 0.9286284704422479),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (9, 0.9273914587405668),
[2024-06-19 18:43:03,491][flwr][INFO] - 	        (10, 0.9351490311676305)],
[2024-06-19 18:43:03,491][flwr][INFO] - 	 'precision': [(0, 0.12349967530374152),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (1, 0.7641582878698121),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (2, 0.8792010174474466),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (3, 0.8962239377867145),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (4, 0.9098321717671782),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (5, 0.9181603240389034),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (6, 0.921087405535254),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (7, 0.9256649982013693),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (8, 0.9293952242404614),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (9, 0.9285931457039475),
[2024-06-19 18:43:03,491][flwr][INFO] - 	               (10, 0.9355728576021455)],
[2024-06-19 18:43:03,491][flwr][INFO] - 	 'recall': [(0, 0.1086),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (1, 0.6879),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (2, 0.8793),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (3, 0.8939),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (4, 0.9096),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (5, 0.9169),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (6, 0.9201),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (7, 0.9252),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (8, 0.9288),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (9, 0.9275),
[2024-06-19 18:43:03,491][flwr][INFO] - 	            (10, 0.9353)]}
[2024-06-19 18:43:03,492][flwr][INFO] - 
