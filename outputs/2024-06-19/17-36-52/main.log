[2024-06-19 17:36:52,345][flwr][INFO] - Starting Flower simulation, config: num_rounds=10, no round_timeout
[2024-06-19 17:36:54,516][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 8000084378.0, 'object_store_memory': 2147483648.0, 'CPU': 12.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0}
[2024-06-19 17:36:54,516][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-06-19 17:36:54,516][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 2, 'num_gpus': 0}
[2024-06-19 17:36:54,527][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 6 actors
[2024-06-19 17:36:54,527][flwr][INFO] - [INIT]
[2024-06-19 17:36:54,527][flwr][INFO] - Requesting initial parameters from one random client
[2024-06-19 17:36:56,589][flwr][INFO] - Received initial parameters from one random client
[2024-06-19 17:36:56,589][flwr][INFO] - Evaluating initial global parameters
[2024-06-19 17:36:57,055][flwr][INFO] - initial parameters (loss, other metrics): 181.76928067207336, {'accuracy': 0.1086, 'precision': 0.12349967530374152, 'recall': 0.1086, 'f1': 0.03553137346181725, 'confusion_matrix': array([[   0,    8,    0,  956,    0,    1,    0,   15,    0,    0],
       [   0,  122,    0, 1013,    0,    0,    0,    0,    0,    0],
       [   0,   38,    0,  971,    0,    0,    3,   19,    1,    0],
       [   0,   44,    0,  945,    1,    1,    0,   17,    2,    0],
       [   0,  143,    0,  816,    1,    0,    2,   20,    0,    0],
       [   0,  118,    0,  735,    1,    7,    0,   30,    1,    0],
       [   0,  144,    0,  749,   25,    0,    2,   38,    0,    0],
       [   0,  272,    0,  724,    8,    0,    0,    9,   15,    0],
       [   0,   81,    0,  859,    1,    0,    1,   32,    0,    0],
       [   0,  178,    0,  799,    1,    0,    0,   31,    0,    0]])}
[2024-06-19 17:36:57,056][flwr][INFO] - 
[2024-06-19 17:36:57,056][flwr][INFO] - [ROUND 1]
[2024-06-19 17:36:57,057][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:00,684][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 47883 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 47883 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:00,688][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 47883 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 47883 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:05,209][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 34687 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 34687 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:05,210][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 48501 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 48501 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:05,253][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 34687 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 34687 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:05,260][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 48501 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 48501 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:05,280][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 55164 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 55164 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:05,281][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 55164 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 55164 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:05,482][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 9966 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 9966 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:05,483][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 9966 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 9966 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:07,410][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:07,418][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-06-19 17:37:07,854][flwr][INFO] - fit progress: (1, 67.5859517455101, {'accuracy': 0.7521, 'precision': 0.7882315268895969, 'recall': 0.7521, 'f1': 0.7467634240206614, 'confusion_matrix': array([[ 845,    0,    3,   39,    0,   21,   65,    5,    2,    0],
       [   0, 1082,    1,   16,    0,    0,    5,    1,   30,    0],
       [   9,   13,  666,  201,   10,    1,   76,   32,   13,   11],
       [   5,    8,   10,  909,    0,    5,   10,   30,   23,   10],
       [   0,    7,    3,    0,  504,    1,   45,   13,   12,  397],
       [  11,   31,    3,  306,   35,  357,   45,   43,   46,   15],
       [  17,   11,    3,    3,   11,    7,  903,    1,    2,    0],
       [   1,   21,   11,    9,    6,    0,    0,  959,    6,   15],
       [   5,   27,   10,  214,    3,   18,   17,   31,  607,   42],
       [   7,    8,    1,   16,   22,    6,    5,  244,   11,  689]])}, 10.798044)
[2024-06-19 17:37:07,855][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:07,855][flwr][INFO] - 
[2024-06-19 17:37:07,855][flwr][INFO] - [ROUND 2]
[2024-06-19 17:37:07,855][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:11,898][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 83356 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 83356 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:11,899][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 72361 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 72361 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:11,903][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 83356 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 83356 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:11,903][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 72361 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 72361 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:12,011][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 35372 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 35372 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:12,012][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 35372 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 35372 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:12,062][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 72859 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 72859 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:12,064][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 22079 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 22079 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:12,064][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 72859 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 72859 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:12,064][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 22079 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 22079 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:14,563][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:15,010][flwr][INFO] - fit progress: (2, 34.52641171962023, {'accuracy': 0.8746, 'precision': 0.8750633830788367, 'recall': 0.8746, 'f1': 0.873921467879307, 'confusion_matrix': array([[ 946,    0,    0,    2,    1,   12,   16,    1,    2,    0],
       [   0, 1084,    2,    7,    1,    5,    7,    1,   28,    0],
       [  23,    8,  815,   57,   16,    0,   39,   14,   46,   14],
       [  14,    3,   19,  864,    0,   41,    4,   20,   31,   14],
       [   0,    7,    3,    0,  879,    0,   17,    1,    1,   74],
       [  26,    5,    4,   53,   35,  703,   29,   12,   17,    8],
       [  26,    6,    4,    0,   18,   15,  888,    0,    1,    0],
       [   3,   20,   25,    3,    9,    0,    0,  920,    3,   45],
       [   6,   11,   14,   35,   21,   51,   17,    7,  781,   31],
       [   7,    5,    2,    6,   54,   18,    1,   39,   11,  866]])}, 17.953994458)
[2024-06-19 17:37:15,010][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:15,010][flwr][INFO] - 
[2024-06-19 17:37:15,010][flwr][INFO] - [ROUND 3]
[2024-06-19 17:37:15,011][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:17,863][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 95015 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 95015 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:17,875][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 95015 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 95015 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:17,904][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 65927 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 65927 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:17,905][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 65927 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 65927 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:18,012][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 25961 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 25961 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:18,027][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 25961 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 25961 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:18,036][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 74799 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 74799 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:18,037][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 74799 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 74799 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:18,039][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 54654 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 54654 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:18,039][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 54654 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 54654 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:20,665][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:21,114][flwr][INFO] - fit progress: (3, 28.558670975267887, {'accuracy': 0.8976, 'precision': 0.8981397521654275, 'recall': 0.8976, 'f1': 0.8973405886484428, 'confusion_matrix': array([[ 952,    0,    2,    4,    0,   11,    7,    1,    3,    0],
       [   0, 1094,    3,    5,    1,    2,    3,    1,   26,    0],
       [  15,    6,  902,   25,   17,    3,   16,   14,   26,    8],
       [   4,    2,   27,  912,    0,   26,    0,   16,   14,    9],
       [   1,    2,    5,    0,  897,    1,   12,    1,    3,   60],
       [  17,    3,    9,   63,   16,  732,    9,    8,   25,   10],
       [  23,    4,    7,    0,   24,   17,  881,    0,    2,    0],
       [   3,    9,   30,    2,   10,    0,    0,  908,    4,   62],
       [  10,    6,   22,   50,   11,   42,   14,    9,  791,   19],
       [  12,    5,    4,   10,   38,   10,    1,   15,    7,  907]])}, 24.058280208000003)
[2024-06-19 17:37:21,114][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:21,114][flwr][INFO] - 
[2024-06-19 17:37:21,114][flwr][INFO] - [ROUND 4]
[2024-06-19 17:37:21,115][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:24,114][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 13643 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 13643 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:24,116][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 13643 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 13643 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:24,355][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 97515 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 97515 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:24,358][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 97515 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 97515 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:24,448][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 19393 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 19393 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:24,449][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 19393 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 19393 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:24,502][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 88717 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 88717 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:24,503][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 88717 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 88717 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:24,541][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 79075 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 79075 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:24,541][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 79075 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 79075 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:26,635][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:27,076][flwr][INFO] - fit progress: (4, 26.394954323768616, {'accuracy': 0.8944, 'precision': 0.8986272396103775, 'recall': 0.8944, 'f1': 0.8940513714536066, 'confusion_matrix': array([[ 958,    0,    4,    2,    0,    5,    6,    3,    2,    0],
       [   0, 1112,    4,    4,    0,    1,    3,    1,   10,    0],
       [  12,   14,  891,   24,    9,    0,   11,   23,   37,   11],
       [   4,    2,   29,  893,    0,   24,    1,   16,   27,   14],
       [   1,    8,    7,    0,  724,    0,   13,    1,    8,  220],
       [  11,    8,    8,   48,    5,  747,   11,   18,   23,   13],
       [  23,    5,    4,    0,   17,   16,  890,    1,    2,    0],
       [   0,   17,   29,    0,    4,    0,    0,  942,    2,   34],
       [   5,    8,   13,   24,    4,   31,   13,   11,  841,   24],
       [  10,    5,    1,    6,    9,    8,    1,   16,    7,  946]])}, 30.020655)
[2024-06-19 17:37:27,077][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:27,077][flwr][INFO] - 
[2024-06-19 17:37:27,077][flwr][INFO] - [ROUND 5]
[2024-06-19 17:37:27,077][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:30,059][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 81997 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 81997 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:30,074][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 81997 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 81997 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:30,085][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 66247 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 66247 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:30,086][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 66247 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 66247 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:30,119][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 12674 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 12674 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:30,134][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 12674 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 12674 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:30,143][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 672 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 672 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:30,144][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 672 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 672 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:30,145][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 39425 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 39425 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:30,146][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 39425 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 39425 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:32,487][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:32,936][flwr][INFO] - fit progress: (5, 23.46167129650712, {'accuracy': 0.912, 'precision': 0.9132301933942856, 'recall': 0.912, 'f1': 0.912150901652759, 'confusion_matrix': array([[ 963,    0,    1,    1,    0,    6,    3,    2,    4,    0],
       [   0, 1079,    4,    5,    1,    1,    3,    2,   40,    0],
       [  13,    1,  900,   20,   16,    4,    8,   17,   49,    4],
       [   5,    1,   17,  883,    1,   43,    2,   18,   26,   14],
       [   1,    1,    6,    0,  916,    1,   10,    0,    8,   39],
       [  13,    3,    4,   26,   11,  783,    7,   12,   27,    6],
       [  22,    2,    6,    0,   16,   26,  879,    1,    6,    0],
       [   0,    8,   22,    2,    7,    0,    0,  947,    5,   37],
       [   5,    1,    7,   11,   16,   27,    7,    9,  873,   18],
       [  13,    5,    1,    8,   48,   11,    1,   16,    9,  897]])}, 35.88052462500001)
[2024-06-19 17:37:32,936][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:32,936][flwr][INFO] - 
[2024-06-19 17:37:32,936][flwr][INFO] - [ROUND 6]
[2024-06-19 17:37:32,937][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:36,506][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 69504 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 69504 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:36,508][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 69504 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 69504 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:36,629][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 93906 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 93906 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:36,630][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 93906 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 93906 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:36,685][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 91582 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 91582 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:36,686][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 40689 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 40689 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:36,686][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 91582 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 91582 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:36,687][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 40689 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 40689 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:36,688][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 89022 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 89022 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:36,688][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 89022 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 89022 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:38,904][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:39,367][flwr][INFO] - fit progress: (6, 21.230257053859532, {'accuracy': 0.9194, 'precision': 0.920004593956612, 'recall': 0.9194, 'f1': 0.9192250790188716, 'confusion_matrix': array([[ 953,    0,    2,    0,    1,    7,   12,    1,    4,    0],
       [   0, 1111,    3,    3,    1,    0,    3,    1,   13,    0],
       [  10,    7,  907,   17,   13,    2,   12,   19,   40,    5],
       [   3,    1,   18,  898,    0,   23,    3,   16,   34,   14],
       [   1,    2,    4,    0,  930,    0,   16,    1,    6,   22],
       [   7,    4,    2,   29,   16,  775,   23,    8,   23,    5],
       [  12,    4,    2,    0,   11,    8,  919,    0,    2,    0],
       [   1,   13,   15,    3,   12,    0,    0,  949,    3,   32],
       [   3,    7,    7,   16,   16,   19,   12,   11,  867,   16],
       [   7,    6,    0,    6,   68,    9,    1,   15,   12,  885]])}, 42.312089)
[2024-06-19 17:37:39,368][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:39,368][flwr][INFO] - 
[2024-06-19 17:37:39,368][flwr][INFO] - [ROUND 7]
[2024-06-19 17:37:39,368][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:42,361][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 48568 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 48568 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:42,363][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 48568 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 48568 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:42,449][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 81314 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 81314 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:42,452][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 81314 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 81314 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:42,532][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 21809 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 21809 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:42,534][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 21809 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 21809 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:42,570][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 28834 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 28834 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:42,571][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 28834 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 28834 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:42,572][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 24648 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 24648 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:42,572][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 24648 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 24648 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:44,818][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:45,277][flwr][INFO] - fit progress: (7, 21.166363462805748, {'accuracy': 0.9212, 'precision': 0.9220372119707414, 'recall': 0.9212, 'f1': 0.921105832379357, 'confusion_matrix': array([[ 964,    0,    0,    0,    0,    3,   10,    1,    2,    0],
       [   0, 1100,    1,    3,    1,    1,    9,    1,   19,    0],
       [  14,    3,  905,   17,   15,    2,   27,   11,   36,    2],
       [   6,    1,   14,  897,    0,   39,    4,   13,   29,    7],
       [   1,    1,    4,    0,  929,    1,   17,    1,    4,   24],
       [   9,    1,    0,   15,    9,  815,   14,    5,   19,    5],
       [  19,    3,    2,    0,    9,   14,  911,    0,    0,    0],
       [   5,    9,   20,    3,   12,    1,    1,  935,    5,   37],
       [   8,    4,    5,   15,   13,   39,   17,    8,  858,    7],
       [  14,    5,    1,    7,   42,   12,    2,   13,   15,  898]])}, 48.222400041)
[2024-06-19 17:37:45,278][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:45,278][flwr][INFO] - 
[2024-06-19 17:37:45,278][flwr][INFO] - [ROUND 8]
[2024-06-19 17:37:45,279][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:48,264][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 43764 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 43764 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:48,265][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 43764 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 43764 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:48,328][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 58578 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 58578 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:48,344][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 58578 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 58578 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:48,356][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 38339 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 38339 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:48,374][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 38339 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 38339 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:48,384][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 31844 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 31844 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:48,388][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 31844 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 31844 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:48,396][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 71237 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 71237 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:48,397][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 71237 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 71237 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:50,642][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:51,090][flwr][INFO] - fit progress: (8, 19.14729588292539, {'accuracy': 0.9263, 'precision': 0.9275790732226067, 'recall': 0.9263, 'f1': 0.926234429061911, 'confusion_matrix': array([[ 966,    0,    1,    0,    0,    4,    5,    2,    2,    0],
       [   0, 1113,    4,    3,    1,    0,    5,    1,    8,    0],
       [  14,    5,  961,    7,    8,    1,    2,   13,   14,    7],
       [   6,    2,   22,  918,    0,    9,    2,   14,   25,   12],
       [   1,    1,    7,    0,  879,    0,   10,    0,    4,   80],
       [  20,    1,    8,   29,    8,  778,   13,    4,   18,   13],
       [  25,    3,    7,    0,   10,    4,  907,    1,    1,    0],
       [   4,    8,   24,    2,    7,    0,    0,  941,    1,   41],
       [  15,    6,   12,   23,   12,   23,   11,    4,  848,   20],
       [  10,    6,    1,   10,   15,    2,    1,    6,    6,  952]])}, 54.035042875)
[2024-06-19 17:37:51,091][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:51,091][flwr][INFO] - 
[2024-06-19 17:37:51,091][flwr][INFO] - [ROUND 9]
[2024-06-19 17:37:51,091][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:54,068][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 47162 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 47162 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:54,069][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 47162 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 47162 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:54,112][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 44550 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 44550 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:54,112][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 44550 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 44550 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:54,201][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 45083 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 45083 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:54,201][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 27979 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 27979 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:54,202][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 45083 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 45083 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:54,202][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 27979 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 27979 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:54,209][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 45118 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 45118 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:54,210][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 45118 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85107, ip=127.0.0.1, actor_id=e387976dd3193aafa3fcfede01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1193e6ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 45118 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:56,378][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:37:56,827][flwr][INFO] - fit progress: (9, 18.50190416816622, {'accuracy': 0.9334, 'precision': 0.9342001452069455, 'recall': 0.9334, 'f1': 0.9334093968123583, 'confusion_matrix': array([[ 965,    0,    1,    0,    0,    3,    7,    1,    3,    0],
       [   0, 1106,    2,    3,    1,    0,    5,    0,   18,    0],
       [   8,    0,  951,   16,   11,    2,    6,    5,   32,    1],
       [   1,    0,   11,  937,    0,   22,    1,   10,   24,    4],
       [   1,    1,    6,    0,  924,    0,   16,    2,    9,   23],
       [   7,    1,    2,   27,    6,  794,   12,    6,   31,    6],
       [  15,    2,    1,    0,   14,    6,  915,    0,    5,    0],
       [   4,    6,   38,    4,    9,    1,    0,  939,    3,   24],
       [   4,    1,    5,   18,    9,   12,    5,    4,  911,    5],
       [  12,    5,    2,   10,   49,    7,    1,   14,   17,  892]])}, 59.772443291)
[2024-06-19 17:37:56,828][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:37:56,828][flwr][INFO] - 
[2024-06-19 17:37:56,828][flwr][INFO] - [ROUND 10]
[2024-06-19 17:37:56,828][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 17:37:59,654][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 5491 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 5491 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:59,655][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 5491 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85106, ip=127.0.0.1, actor_id=43aea67353f5336702d7584e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x113c5aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 5491 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:59,751][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 5682 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 5682 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:59,752][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 5682 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85109, ip=127.0.0.1, actor_id=6c1b79a43b6b7f987cc0d9d601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x111b17a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 5682 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:59,796][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 41569 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 41569 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:59,812][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 41569 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85104, ip=127.0.0.1, actor_id=e551716a0a93cd4376b3831601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x12c6eeaf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 41569 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:59,824][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 52992 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 52992 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:59,826][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 52992 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85108, ip=127.0.0.1, actor_id=f10f0a5636b6be7fed0a5be601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x110fd7b20>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 52992 is out of bounds for dimension 0 with size 128
[2024-06-19 17:37:59,844][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 19025 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 19025 is out of bounds for dimension 0 with size 128

[2024-06-19 17:37:59,844][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 223, in controllable_mpaf_attack_nn
    w_base[zero_indices] = 0
IndexError: index 19025 is out of bounds for dimension 0 with size 128

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=85105, ip=127.0.0.1, actor_id=70dd90f5e7723d8f033cb23801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10e442af0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 19025 is out of bounds for dimension 0 with size 128
[2024-06-19 17:38:02,134][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 17:38:02,583][flwr][INFO] - fit progress: (10, 17.44031474273652, {'accuracy': 0.9355, 'precision': 0.9361246475909687, 'recall': 0.9355, 'f1': 0.9354489652055107, 'confusion_matrix': array([[ 966,    0,    1,    0,    0,    2,    7,    1,    3,    0],
       [   0, 1112,    1,    3,    1,    0,    6,    0,   12,    0],
       [   8,    2,  947,   15,    5,    0,   14,   11,   23,    7],
       [   4,    1,   14,  925,    0,   30,    2,   12,   16,    6],
       [   2,    1,    4,    0,  873,    1,   17,    3,    4,   77],
       [  12,    2,    1,   16,    3,  811,   18,    1,   22,    6],
       [  15,    3,    1,    0,    3,    3,  928,    1,    4,    0],
       [   3,    8,   17,    6,    2,    1,    0,  966,    0,   25],
       [   7,    3,    5,   19,    8,   17,    8,    7,  889,   11],
       [  10,    7,    0,   13,   17,    5,    2,   10,    7,  938]])}, 65.528522708)
[2024-06-19 17:38:02,584][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 17:38:02,584][flwr][INFO] - 
[2024-06-19 17:38:02,584][flwr][INFO] - [SUMMARY]
[2024-06-19 17:38:02,584][flwr][INFO] - Run finished 10 round(s) in 65.53s
[2024-06-19 17:38:02,589][flwr][INFO] - 	History (loss, centralized):
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 0: 181.76928067207336
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 1: 67.5859517455101
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 2: 34.52641171962023
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 3: 28.558670975267887
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 4: 26.394954323768616
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 5: 23.46167129650712
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 6: 21.230257053859532
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 7: 21.166363462805748
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 8: 19.14729588292539
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 9: 18.50190416816622
[2024-06-19 17:38:02,589][flwr][INFO] - 		round 10: 17.44031474273652
[2024-06-19 17:38:02,589][flwr][INFO] - 	History (metrics, centralized):
[2024-06-19 17:38:02,589][flwr][INFO] - 	{'accuracy': [(0, 0.1086),
[2024-06-19 17:38:02,589][flwr][INFO] - 	              (1, 0.7521),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (2, 0.8746),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (3, 0.8976),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (4, 0.8944),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (5, 0.912),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (6, 0.9194),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (7, 0.9212),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (8, 0.9263),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (9, 0.9334),
[2024-06-19 17:38:02,590][flwr][INFO] - 	              (10, 0.9355)],
[2024-06-19 17:38:02,590][flwr][INFO] - 	 'confusion_matrix': [(0,
[2024-06-19 17:38:02,590][flwr][INFO] - 	                       array([[   0,    8,    0,  956,    0,    1,    0,   15,    0,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,  122,    0, 1013,    0,    0,    0,    0,    0,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,   38,    0,  971,    0,    0,    3,   19,    1,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,   44,    0,  945,    1,    1,    0,   17,    2,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,  143,    0,  816,    1,    0,    2,   20,    0,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,  118,    0,  735,    1,    7,    0,   30,    1,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,  144,    0,  749,   25,    0,    2,   38,    0,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,  272,    0,  724,    8,    0,    0,    9,   15,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,   81,    0,  859,    1,    0,    1,   32,    0,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,  178,    0,  799,    1,    0,    0,   31,    0,    0]])),
[2024-06-19 17:38:02,590][flwr][INFO] - 	                      (1,
[2024-06-19 17:38:02,590][flwr][INFO] - 	                       array([[ 845,    0,    3,   39,    0,   21,   65,    5,    2,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0, 1082,    1,   16,    0,    0,    5,    1,   30,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   9,   13,  666,  201,   10,    1,   76,   32,   13,   11],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   5,    8,   10,  909,    0,    5,   10,   30,   23,   10],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,    7,    3,    0,  504,    1,   45,   13,   12,  397],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [  11,   31,    3,  306,   35,  357,   45,   43,   46,   15],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [  17,   11,    3,    3,   11,    7,  903,    1,    2,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   1,   21,   11,    9,    6,    0,    0,  959,    6,   15],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   5,   27,   10,  214,    3,   18,   17,   31,  607,   42],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   7,    8,    1,   16,   22,    6,    5,  244,   11,  689]])),
[2024-06-19 17:38:02,590][flwr][INFO] - 	                      (2,
[2024-06-19 17:38:02,590][flwr][INFO] - 	                       array([[ 946,    0,    0,    2,    1,   12,   16,    1,    2,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0, 1084,    2,    7,    1,    5,    7,    1,   28,    0],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [  23,    8,  815,   57,   16,    0,   39,   14,   46,   14],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [  14,    3,   19,  864,    0,   41,    4,   20,   31,   14],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [   0,    7,    3,    0,  879,    0,   17,    1,    1,   74],
[2024-06-19 17:38:02,590][flwr][INFO] - 	       [  26,    5,    4,   53,   35,  703,   29,   12,   17,    8],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  26,    6,    4,    0,   18,   15,  888,    0,    1,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   3,   20,   25,    3,    9,    0,    0,  920,    3,   45],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   6,   11,   14,   35,   21,   51,   17,    7,  781,   31],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   7,    5,    2,    6,   54,   18,    1,   39,   11,  866]])),
[2024-06-19 17:38:02,591][flwr][INFO] - 	                      (3,
[2024-06-19 17:38:02,591][flwr][INFO] - 	                       array([[ 952,    0,    2,    4,    0,   11,    7,    1,    3,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   0, 1094,    3,    5,    1,    2,    3,    1,   26,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  15,    6,  902,   25,   17,    3,   16,   14,   26,    8],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   4,    2,   27,  912,    0,   26,    0,   16,   14,    9],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   1,    2,    5,    0,  897,    1,   12,    1,    3,   60],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  17,    3,    9,   63,   16,  732,    9,    8,   25,   10],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  23,    4,    7,    0,   24,   17,  881,    0,    2,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   3,    9,   30,    2,   10,    0,    0,  908,    4,   62],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  10,    6,   22,   50,   11,   42,   14,    9,  791,   19],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  12,    5,    4,   10,   38,   10,    1,   15,    7,  907]])),
[2024-06-19 17:38:02,591][flwr][INFO] - 	                      (4,
[2024-06-19 17:38:02,591][flwr][INFO] - 	                       array([[ 958,    0,    4,    2,    0,    5,    6,    3,    2,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   0, 1112,    4,    4,    0,    1,    3,    1,   10,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  12,   14,  891,   24,    9,    0,   11,   23,   37,   11],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   4,    2,   29,  893,    0,   24,    1,   16,   27,   14],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   1,    8,    7,    0,  724,    0,   13,    1,    8,  220],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  11,    8,    8,   48,    5,  747,   11,   18,   23,   13],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  23,    5,    4,    0,   17,   16,  890,    1,    2,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   0,   17,   29,    0,    4,    0,    0,  942,    2,   34],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   5,    8,   13,   24,    4,   31,   13,   11,  841,   24],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  10,    5,    1,    6,    9,    8,    1,   16,    7,  946]])),
[2024-06-19 17:38:02,591][flwr][INFO] - 	                      (5,
[2024-06-19 17:38:02,591][flwr][INFO] - 	                       array([[ 963,    0,    1,    1,    0,    6,    3,    2,    4,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   0, 1079,    4,    5,    1,    1,    3,    2,   40,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  13,    1,  900,   20,   16,    4,    8,   17,   49,    4],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   5,    1,   17,  883,    1,   43,    2,   18,   26,   14],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   1,    1,    6,    0,  916,    1,   10,    0,    8,   39],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  13,    3,    4,   26,   11,  783,    7,   12,   27,    6],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  22,    2,    6,    0,   16,   26,  879,    1,    6,    0],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   0,    8,   22,    2,    7,    0,    0,  947,    5,   37],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [   5,    1,    7,   11,   16,   27,    7,    9,  873,   18],
[2024-06-19 17:38:02,591][flwr][INFO] - 	       [  13,    5,    1,    8,   48,   11,    1,   16,    9,  897]])),
[2024-06-19 17:38:02,592][flwr][INFO] - 	                      (6,
[2024-06-19 17:38:02,592][flwr][INFO] - 	                       array([[ 953,    0,    2,    0,    1,    7,   12,    1,    4,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   0, 1111,    3,    3,    1,    0,    3,    1,   13,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  10,    7,  907,   17,   13,    2,   12,   19,   40,    5],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   3,    1,   18,  898,    0,   23,    3,   16,   34,   14],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   1,    2,    4,    0,  930,    0,   16,    1,    6,   22],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   7,    4,    2,   29,   16,  775,   23,    8,   23,    5],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  12,    4,    2,    0,   11,    8,  919,    0,    2,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   1,   13,   15,    3,   12,    0,    0,  949,    3,   32],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   3,    7,    7,   16,   16,   19,   12,   11,  867,   16],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   7,    6,    0,    6,   68,    9,    1,   15,   12,  885]])),
[2024-06-19 17:38:02,592][flwr][INFO] - 	                      (7,
[2024-06-19 17:38:02,592][flwr][INFO] - 	                       array([[ 964,    0,    0,    0,    0,    3,   10,    1,    2,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   0, 1100,    1,    3,    1,    1,    9,    1,   19,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  14,    3,  905,   17,   15,    2,   27,   11,   36,    2],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   6,    1,   14,  897,    0,   39,    4,   13,   29,    7],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   1,    1,    4,    0,  929,    1,   17,    1,    4,   24],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   9,    1,    0,   15,    9,  815,   14,    5,   19,    5],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  19,    3,    2,    0,    9,   14,  911,    0,    0,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   5,    9,   20,    3,   12,    1,    1,  935,    5,   37],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   8,    4,    5,   15,   13,   39,   17,    8,  858,    7],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  14,    5,    1,    7,   42,   12,    2,   13,   15,  898]])),
[2024-06-19 17:38:02,592][flwr][INFO] - 	                      (8,
[2024-06-19 17:38:02,592][flwr][INFO] - 	                       array([[ 966,    0,    1,    0,    0,    4,    5,    2,    2,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   0, 1113,    4,    3,    1,    0,    5,    1,    8,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  14,    5,  961,    7,    8,    1,    2,   13,   14,    7],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   6,    2,   22,  918,    0,    9,    2,   14,   25,   12],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   1,    1,    7,    0,  879,    0,   10,    0,    4,   80],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  20,    1,    8,   29,    8,  778,   13,    4,   18,   13],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  25,    3,    7,    0,   10,    4,  907,    1,    1,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   4,    8,   24,    2,    7,    0,    0,  941,    1,   41],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  15,    6,   12,   23,   12,   23,   11,    4,  848,   20],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [  10,    6,    1,   10,   15,    2,    1,    6,    6,  952]])),
[2024-06-19 17:38:02,592][flwr][INFO] - 	                      (9,
[2024-06-19 17:38:02,592][flwr][INFO] - 	                       array([[ 965,    0,    1,    0,    0,    3,    7,    1,    3,    0],
[2024-06-19 17:38:02,592][flwr][INFO] - 	       [   0, 1106,    2,    3,    1,    0,    5,    0,   18,    0],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   8,    0,  951,   16,   11,    2,    6,    5,   32,    1],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   1,    0,   11,  937,    0,   22,    1,   10,   24,    4],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   1,    1,    6,    0,  924,    0,   16,    2,    9,   23],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   7,    1,    2,   27,    6,  794,   12,    6,   31,    6],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [  15,    2,    1,    0,   14,    6,  915,    0,    5,    0],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   4,    6,   38,    4,    9,    1,    0,  939,    3,   24],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   4,    1,    5,   18,    9,   12,    5,    4,  911,    5],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [  12,    5,    2,   10,   49,    7,    1,   14,   17,  892]])),
[2024-06-19 17:38:02,593][flwr][INFO] - 	                      (10,
[2024-06-19 17:38:02,593][flwr][INFO] - 	                       array([[ 966,    0,    1,    0,    0,    2,    7,    1,    3,    0],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   0, 1112,    1,    3,    1,    0,    6,    0,   12,    0],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   8,    2,  947,   15,    5,    0,   14,   11,   23,    7],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   4,    1,   14,  925,    0,   30,    2,   12,   16,    6],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   2,    1,    4,    0,  873,    1,   17,    3,    4,   77],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [  12,    2,    1,   16,    3,  811,   18,    1,   22,    6],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [  15,    3,    1,    0,    3,    3,  928,    1,    4,    0],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   3,    8,   17,    6,    2,    1,    0,  966,    0,   25],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [   7,    3,    5,   19,    8,   17,    8,    7,  889,   11],
[2024-06-19 17:38:02,593][flwr][INFO] - 	       [  10,    7,    0,   13,   17,    5,    2,   10,    7,  938]]))],
[2024-06-19 17:38:02,593][flwr][INFO] - 	 'f1': [(0, 0.03553137346181725),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (1, 0.7467634240206614),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (2, 0.873921467879307),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (3, 0.8973405886484428),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (4, 0.8940513714536066),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (5, 0.912150901652759),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (6, 0.9192250790188716),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (7, 0.921105832379357),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (8, 0.926234429061911),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (9, 0.9334093968123583),
[2024-06-19 17:38:02,593][flwr][INFO] - 	        (10, 0.9354489652055107)],
[2024-06-19 17:38:02,593][flwr][INFO] - 	 'precision': [(0, 0.12349967530374152),
[2024-06-19 17:38:02,593][flwr][INFO] - 	               (1, 0.7882315268895969),
[2024-06-19 17:38:02,593][flwr][INFO] - 	               (2, 0.8750633830788367),
[2024-06-19 17:38:02,593][flwr][INFO] - 	               (3, 0.8981397521654275),
[2024-06-19 17:38:02,594][flwr][INFO] - 	               (4, 0.8986272396103775),
[2024-06-19 17:38:02,594][flwr][INFO] - 	               (5, 0.9132301933942856),
[2024-06-19 17:38:02,594][flwr][INFO] - 	               (6, 0.920004593956612),
[2024-06-19 17:38:02,594][flwr][INFO] - 	               (7, 0.9220372119707414),
[2024-06-19 17:38:02,594][flwr][INFO] - 	               (8, 0.9275790732226067),
[2024-06-19 17:38:02,594][flwr][INFO] - 	               (9, 0.9342001452069455),
[2024-06-19 17:38:02,594][flwr][INFO] - 	               (10, 0.9361246475909687)],
[2024-06-19 17:38:02,594][flwr][INFO] - 	 'recall': [(0, 0.1086),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (1, 0.7521),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (2, 0.8746),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (3, 0.8976),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (4, 0.8944),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (5, 0.912),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (6, 0.9194),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (7, 0.9212),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (8, 0.9263),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (9, 0.9334),
[2024-06-19 17:38:02,594][flwr][INFO] - 	            (10, 0.9355)]}
[2024-06-19 17:38:02,594][flwr][INFO] - 
