[2024-06-19 18:43:21,109][flwr][INFO] - Starting Flower simulation, config: num_rounds=10, no round_timeout
[2024-06-19 18:43:22,153][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 9383501824.0, 'object_store_memory': 2147483648.0, 'CPU': 12.0, 'node:__internal_head__': 1.0, 'node:127.0.0.1': 1.0}
[2024-06-19 18:43:22,153][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-06-19 18:43:22,153][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 2, 'num_gpus': 0}
[2024-06-19 18:43:22,160][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 6 actors
[2024-06-19 18:43:22,161][flwr][INFO] - [INIT]
[2024-06-19 18:43:22,161][flwr][INFO] - Requesting initial parameters from one random client
[2024-06-19 18:43:24,177][flwr][INFO] - Received initial parameters from one random client
[2024-06-19 18:43:24,177][flwr][INFO] - Evaluating initial global parameters
[2024-06-19 18:43:24,622][flwr][INFO] - initial parameters (loss, other metrics): 181.76928067207336, {'accuracy': 0.1086, 'precision': 0.12349967530374152, 'recall': 0.1086, 'f1': 0.03553137346181725, 'confusion_matrix': array([[   0,    8,    0,  956,    0,    1,    0,   15,    0,    0],
       [   0,  122,    0, 1013,    0,    0,    0,    0,    0,    0],
       [   0,   38,    0,  971,    0,    0,    3,   19,    1,    0],
       [   0,   44,    0,  945,    1,    1,    0,   17,    2,    0],
       [   0,  143,    0,  816,    1,    0,    2,   20,    0,    0],
       [   0,  118,    0,  735,    1,    7,    0,   30,    1,    0],
       [   0,  144,    0,  749,   25,    0,    2,   38,    0,    0],
       [   0,  272,    0,  724,    8,    0,    0,    9,   15,    0],
       [   0,   81,    0,  859,    1,    0,    1,   32,    0,    0],
       [   0,  178,    0,  799,    1,    0,    0,   31,    0,    0]])}
[2024-06-19 18:43:24,623][flwr][INFO] - 
[2024-06-19 18:43:24,623][flwr][INFO] - [ROUND 1]
[2024-06-19 18:43:24,623][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:43:26,951][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:26,952][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:30,229][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:30,245][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:30,282][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:30,283][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:30,310][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:30,311][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:30,336][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:30,337][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:32,266][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:43:32,273][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-06-19 18:43:32,720][flwr][INFO] - fit progress: (1, 72.40953439474106, {'accuracy': 0.7277, 'precision': 0.7713849079857922, 'recall': 0.7277, 'f1': 0.7243643260043434, 'confusion_matrix': array([[892,   0,  20,  16,   0,  18,  26,   3,   4,   1],
       [  0, 820, 163,  31,   0,   0,   2,   1,  91,  27],
       [ 13,   0, 921,  34,   6,   0,  17,  13,  14,  14],
       [ 11,   0,  92, 807,   0,  14,   4,  22,  33,  27],
       [  0,   0,  29,   0, 380,   0,  29,   4,   2, 538],
       [ 24,   1,  48, 217,  25, 418,  17,  52,  54,  36],
       [ 20,   2,  98,   7,   6,  11, 806,   0,   2,   6],
       [  2,   1,  49,   2,   5,   0,   0, 917,   2,  50],
       [  9,   0,  71, 212,   7,  14,   4,  16, 539, 102],
       [ 10,   0,  10,   8,  16,   5,   1, 172,  10, 777]])}, 8.097526708)
[2024-06-19 18:43:32,721][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:43:32,721][flwr][INFO] - 
[2024-06-19 18:43:32,721][flwr][INFO] - [ROUND 2]
[2024-06-19 18:43:32,721][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:43:35,668][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:35,671][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:35,716][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:35,732][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:35,775][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:35,775][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:35,776][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:35,776][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:35,776][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:35,777][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:37,998][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:43:38,435][flwr][INFO] - fit progress: (2, 36.45472879707813, {'accuracy': 0.8698, 'precision': 0.874035973970096, 'recall': 0.8698, 'f1': 0.8693508388259786, 'confusion_matrix': array([[ 932,    0,    5,    2,    0,    4,   32,    1,    4,    0],
       [   0, 1072,   24,    3,    0,    0,    3,    0,   32,    1],
       [  11,    5,  915,    6,   10,    0,   38,   12,   32,    3],
       [   7,    3,   95,  792,    0,   30,    5,   19,   54,    5],
       [   0,    2,    5,    0,  828,    0,   51,    0,    8,   88],
       [  23,    8,   12,   50,   20,  653,   51,   10,   59,    6],
       [  15,    5,    5,    0,    5,    5,  922,    0,    1,    0],
       [   6,   17,   45,    0,    6,    0,    0,  889,    8,   57],
       [  10,    7,   34,   11,   11,   15,   20,    8,  846,   12],
       [  14,    6,    6,    5,   55,    4,    5,   35,   30,  849]])}, 13.812275624999998)
[2024-06-19 18:43:38,436][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:43:38,436][flwr][INFO] - 
[2024-06-19 18:43:38,436][flwr][INFO] - [ROUND 3]
[2024-06-19 18:43:38,436][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:43:43,658][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:43,663][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:43,801][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:43,811][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:43,847][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:43,848][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:43,938][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:43,939][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:43,939][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:43,939][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:46,499][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:43:46,975][flwr][INFO] - fit progress: (3, 29.24212472885847, {'accuracy': 0.8906, 'precision': 0.8929716806815703, 'recall': 0.8906, 'f1': 0.890665420873969, 'confusion_matrix': array([[ 952,    0,    0,    3,    0,   20,    3,    1,    1,    0],
       [   0, 1097,    2,    4,    1,    6,    3,    0,   22,    0],
       [  12,   20,  862,   41,   16,    5,   14,   19,   35,    8],
       [   3,    3,   21,  877,    0,   56,    0,   21,   15,   14],
       [   1,    2,    7,    0,  870,    8,   11,    0,    7,   76],
       [   8,    3,    6,   36,    7,  791,    4,   12,   18,    7],
       [  32,    8,   10,    0,   24,   39,  843,    0,    2,    0],
       [   2,   20,   23,    2,    7,    1,    0,  927,    1,   45],
       [   6,    9,    9,   25,   13,   82,    6,   11,  776,   37],
       [  12,    6,    5,    6,   20,   16,    0,   28,    5,  911]])}, 22.351842333)
[2024-06-19 18:43:46,976][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:43:46,976][flwr][INFO] - 
[2024-06-19 18:43:46,976][flwr][INFO] - [ROUND 4]
[2024-06-19 18:43:46,976][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:43:52,686][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:52,688][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:53,079][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:53,097][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:53,106][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:53,107][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:53,109][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:53,109][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:53,109][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:53,109][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:55,665][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:43:56,114][flwr][INFO] - fit progress: (4, 26.63782177120447, {'accuracy': 0.9041, 'precision': 0.904832492962444, 'recall': 0.9041, 'f1': 0.903928115805412, 'confusion_matrix': array([[ 961,    0,    1,    1,    0,    9,    4,    2,    2,    0],
       [   0, 1109,    6,    3,    1,    0,    3,    2,   11,    0],
       [  11,    7,  900,   22,   17,    2,   13,   19,   31,   10],
       [   4,    2,   22,  904,    1,   33,    2,   17,   16,    9],
       [   1,    0,    5,    0,  864,    1,   12,    0,    7,   92],
       [  16,    3,    6,   42,   16,  742,    9,   20,   25,   13],
       [  24,    4,    9,    0,   23,   13,  883,    0,    2,    0],
       [   1,   10,   22,    4,    8,    0,    0,  933,    2,   48],
       [   7,    9,   11,   36,   14,   26,   10,    8,  825,   28],
       [  11,    6,    0,   10,   32,    4,    0,   19,    7,  920]])}, 31.490935291999996)
[2024-06-19 18:43:56,114][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:43:56,114][flwr][INFO] - 
[2024-06-19 18:43:56,114][flwr][INFO] - [ROUND 5]
[2024-06-19 18:43:56,115][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:43:59,092][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:59,094][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:59,177][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:59,178][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:59,243][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:59,261][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:59,278][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:59,279][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:43:59,320][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:43:59,320][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:01,665][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:44:02,110][flwr][INFO] - fit progress: (5, 23.314840219914913, {'accuracy': 0.9149, 'precision': 0.9157514722238839, 'recall': 0.9149, 'f1': 0.9147236609505935, 'confusion_matrix': array([[ 953,    0,    1,    3,    0,    8,   10,    1,    4,    0],
       [   0, 1106,    1,    3,    1,    1,    4,    0,   19,    0],
       [  10,   17,  889,   26,   18,    1,   15,   16,   34,    6],
       [   1,    6,   15,  904,    1,   36,    1,   13,   25,    8],
       [   1,    1,    5,    0,  929,    2,   11,    0,    9,   24],
       [   6,    4,    1,   35,    6,  778,   15,    5,   37,    5],
       [  17,    6,    4,    0,   14,   10,  903,    0,    4,    0],
       [   1,   24,   20,    6,   12,    0,    0,  906,    4,   55],
       [   5,    8,    6,   17,   10,   18,    6,    4,  887,   13],
       [  12,    8,    0,   10,   62,    6,    0,    7,   10,  894]])}, 37.487393083)
[2024-06-19 18:44:02,111][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:44:02,111][flwr][INFO] - 
[2024-06-19 18:44:02,111][flwr][INFO] - [ROUND 6]
[2024-06-19 18:44:02,111][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:44:04,941][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:04,941][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:04,942][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:04,942][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:04,984][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:04,999][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:05,010][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:05,012][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:05,012][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:05,012][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:07,247][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:44:07,704][flwr][INFO] - fit progress: (6, 23.81901395879686, {'accuracy': 0.9083, 'precision': 0.9123994427850752, 'recall': 0.9083, 'f1': 0.9084561810789009, 'confusion_matrix': array([[ 960,    0,    0,    0,    0,    6,    7,    2,    5,    0],
       [   0, 1103,    1,    4,    1,    0,    4,    1,   21,    0],
       [  15,    7,  876,    8,   12,    5,   14,   21,   68,    6],
       [   5,    2,   20,  828,    0,   82,    3,   15,   47,    8],
       [   0,    1,    5,    0,  825,    2,   14,    2,   12,  121],
       [   7,    2,    0,    8,    4,  812,   12,    7,   35,    5],
       [  14,    3,    2,    0,    9,   19,  899,    0,   12,    0],
       [   2,   14,   17,    6,    4,    0,    0,  949,    2,   34],
       [   5,    2,    1,    9,    5,   19,    7,    7,  910,    9],
       [  11,    5,    0,    4,   16,   14,    0,   18,   20,  921]])}, 43.081443833)
[2024-06-19 18:44:07,705][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:44:07,705][flwr][INFO] - 
[2024-06-19 18:44:07,705][flwr][INFO] - [ROUND 7]
[2024-06-19 18:44:07,705][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:44:10,743][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:10,745][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:10,810][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:10,812][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:10,878][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:10,880][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:10,881][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:10,881][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:10,975][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:10,975][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:13,038][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:44:13,477][flwr][INFO] - fit progress: (7, 22.151601307094097, {'accuracy': 0.9133, 'precision': 0.9148736594032169, 'recall': 0.9133, 'f1': 0.9129627188062602, 'confusion_matrix': array([[ 961,    0,    0,    0,    1,   10,    4,    1,    3,    0],
       [   0, 1122,    1,    3,    1,    2,    4,    1,    1,    0],
       [  11,   16,  925,   15,   14,    8,   11,   12,   19,    1],
       [   4,    7,   16,  912,    0,   33,    1,   14,   13,   10],
       [   2,    2,    5,    0,  932,    1,    9,    1,    2,   28],
       [   7,    1,    1,   25,    8,  814,    8,    6,   16,    6],
       [  20,    4,    2,    0,   14,   35,  879,    0,    4,    0],
       [   1,   23,   31,    4,   10,    1,    0,  929,    0,   29],
       [   4,   32,    6,   24,   28,   59,    8,    8,  783,   22],
       [   5,    8,    0,   10,   84,   10,    0,   10,    6,  876]])}, 48.854454708)
[2024-06-19 18:44:13,478][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:44:13,478][flwr][INFO] - 
[2024-06-19 18:44:13,478][flwr][INFO] - [ROUND 8]
[2024-06-19 18:44:13,478][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:44:16,199][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:16,202][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:16,311][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:16,312][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:16,391][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:16,392][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:16,465][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:16,465][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:16,466][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:16,466][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:18,687][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:44:19,123][flwr][INFO] - fit progress: (8, 20.54139446094632, {'accuracy': 0.9222, 'precision': 0.9240811053523681, 'recall': 0.9222, 'f1': 0.9223250631529212, 'confusion_matrix': array([[ 959,    0,    2,    1,    0,    9,    3,    1,    3,    2],
       [   0, 1113,    1,    4,    1,    1,    4,    0,   11,    0],
       [  10,    5,  943,   23,    9,    0,    7,    7,   24,    4],
       [   1,    3,   12,  944,    0,   13,    3,    8,   17,    9],
       [   2,    1,    7,    0,  892,    3,    7,    0,    4,   66],
       [   9,    3,    1,   67,    3,  770,    9,    3,   20,    7],
       [  10,    5,    4,    1,   15,   23,  892,    0,    8,    0],
       [   1,   14,   23,   12,    5,    0,    0,  893,    0,   80],
       [   4,    7,    7,   26,   15,   21,    3,    3,  874,   14],
       [   7,    7,    0,    8,   28,    5,    0,    3,    9,  942]])}, 54.500252333)
[2024-06-19 18:44:19,123][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:44:19,124][flwr][INFO] - 
[2024-06-19 18:44:19,124][flwr][INFO] - [ROUND 9]
[2024-06-19 18:44:19,124][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:44:22,318][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:22,319][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:22,356][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:22,371][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:22,400][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:22,400][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:22,401][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:22,402][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:22,402][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:22,402][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88132, ip=127.0.0.1, actor_id=0139731a6eb5c87eea90bcd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x114b12ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:26,203][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:44:26,691][flwr][INFO] - fit progress: (9, 19.435069580562413, {'accuracy': 0.9263, 'precision': 0.9277417324177557, 'recall': 0.9263, 'f1': 0.9263716290140819, 'confusion_matrix': array([[ 968,    0,    0,    0,    0,    4,    3,    1,    3,    1],
       [   0, 1112,    0,    4,    1,    1,    4,    0,   13,    0],
       [  19,    5,  914,   19,   16,    5,    5,   17,   27,    5],
       [   6,    3,    7,  899,    1,   47,    1,   12,   23,   11],
       [   2,    2,    4,    0,  913,    2,    8,    0,    3,   48],
       [  12,    1,    0,    8,    8,  831,    6,    4,   13,    9],
       [  21,    3,    1,    0,   21,   22,  885,    0,    5,    0],
       [   3,   14,   18,    7,    8,    0,    0,  933,    2,   43],
       [   7,    2,    3,   13,   10,   35,    2,    4,  884,   14],
       [  10,    9,    0,    5,   37,   12,    0,    5,    7,  924]])}, 62.068096708)
[2024-06-19 18:44:26,691][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:44:26,691][flwr][INFO] - 
[2024-06-19 18:44:26,692][flwr][INFO] - [ROUND 10]
[2024-06-19 18:44:26,692][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-19 18:44:31,065][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:31,067][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88137, ip=127.0.0.1, actor_id=cbbc297edb183cb43e1196bb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107dd7a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:31,115][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:31,135][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88133, ip=127.0.0.1, actor_id=c3b4faeffc806036d788006c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10aa97a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:31,173][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:31,174][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88135, ip=127.0.0.1, actor_id=5a199bed118b56f7e3551b5f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x116c3faf0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:31,189][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:31,190][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88134, ip=127.0.0.1, actor_id=0911dd581f7dc3950cfca2b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1124d3a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:31,192][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous

[2024-06-19 18:44:31,193][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 139, in fit
    return self.get_parameters({}), len(trainloader), {}
  File "/Users/charansr/Stamp2024/client.py", line 88, in get_parameters
    state_dict = controllable_mpaf_attack_nn(state_dict, self.device, self.weight_ratio)
  File "/Users/charansr/Stamp2024/attacks.py", line 255, in controllable_mpaf_attack_nn
    print(max(w_base))
RuntimeError: Boolean value of Tensor with more than one value is ambiguous

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=88136, ip=127.0.0.1, actor_id=2fb65d33dede735cfd21df7d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1139d7a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Boolean value of Tensor with more than one value is ambiguous
[2024-06-19 18:44:33,433][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2024-06-19 18:44:33,883][flwr][INFO] - fit progress: (10, 18.50501534715295, {'accuracy': 0.9309, 'precision': 0.9328074574556285, 'recall': 0.9309, 'f1': 0.9310128711920461, 'confusion_matrix': array([[ 970,    0,    0,    0,    0,    3,    1,    2,    3,    1],
       [   0, 1121,    1,    3,    1,    0,    3,    0,    6,    0],
       [   9,    6,  956,    6,    4,    2,    6,   20,   19,    4],
       [   3,    5,   15,  924,    0,   22,    0,   11,   20,   10],
       [   4,    3,    6,    0,  836,    0,    9,    1,    9,  114],
       [   7,    2,    2,   15,    1,  812,    7,    9,   30,    7],
       [  14,    4,    3,    0,   10,   24,  893,    0,   10,    0],
       [   1,   12,   19,    6,    3,    0,    0,  951,    0,   36],
       [   5,    4,    3,   16,    6,   10,    2,    6,  899,   23],
       [   8,    9,    0,    7,   10,    5,    0,    9,   14,  947]])}, 69.260761042)
[2024-06-19 18:44:33,884][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-19 18:44:33,884][flwr][INFO] - 
[2024-06-19 18:44:33,884][flwr][INFO] - [SUMMARY]
[2024-06-19 18:44:33,884][flwr][INFO] - Run finished 10 round(s) in 69.26s
[2024-06-19 18:44:33,889][flwr][INFO] - 	History (loss, centralized):
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 0: 181.76928067207336
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 1: 72.40953439474106
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 2: 36.45472879707813
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 3: 29.24212472885847
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 4: 26.63782177120447
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 5: 23.314840219914913
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 6: 23.81901395879686
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 7: 22.151601307094097
[2024-06-19 18:44:33,890][flwr][INFO] - 		round 8: 20.54139446094632
[2024-06-19 18:44:33,891][flwr][INFO] - 		round 9: 19.435069580562413
[2024-06-19 18:44:33,891][flwr][INFO] - 		round 10: 18.50501534715295
[2024-06-19 18:44:33,891][flwr][INFO] - 	History (metrics, centralized):
[2024-06-19 18:44:33,891][flwr][INFO] - 	{'accuracy': [(0, 0.1086),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (1, 0.7277),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (2, 0.8698),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (3, 0.8906),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (4, 0.9041),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (5, 0.9149),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (6, 0.9083),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (7, 0.9133),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (8, 0.9222),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (9, 0.9263),
[2024-06-19 18:44:33,891][flwr][INFO] - 	              (10, 0.9309)],
[2024-06-19 18:44:33,891][flwr][INFO] - 	 'confusion_matrix': [(0,
[2024-06-19 18:44:33,891][flwr][INFO] - 	                       array([[   0,    8,    0,  956,    0,    1,    0,   15,    0,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,  122,    0, 1013,    0,    0,    0,    0,    0,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,   38,    0,  971,    0,    0,    3,   19,    1,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,   44,    0,  945,    1,    1,    0,   17,    2,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,  143,    0,  816,    1,    0,    2,   20,    0,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,  118,    0,  735,    1,    7,    0,   30,    1,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,  144,    0,  749,   25,    0,    2,   38,    0,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,  272,    0,  724,    8,    0,    0,    9,   15,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,   81,    0,  859,    1,    0,    1,   32,    0,    0],
[2024-06-19 18:44:33,891][flwr][INFO] - 	       [   0,  178,    0,  799,    1,    0,    0,   31,    0,    0]])),
[2024-06-19 18:44:33,892][flwr][INFO] - 	                      (1,
[2024-06-19 18:44:33,892][flwr][INFO] - 	                       array([[892,   0,  20,  16,   0,  18,  26,   3,   4,   1],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  0, 820, 163,  31,   0,   0,   2,   1,  91,  27],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [ 13,   0, 921,  34,   6,   0,  17,  13,  14,  14],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [ 11,   0,  92, 807,   0,  14,   4,  22,  33,  27],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  0,   0,  29,   0, 380,   0,  29,   4,   2, 538],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [ 24,   1,  48, 217,  25, 418,  17,  52,  54,  36],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [ 20,   2,  98,   7,   6,  11, 806,   0,   2,   6],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  2,   1,  49,   2,   5,   0,   0, 917,   2,  50],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  9,   0,  71, 212,   7,  14,   4,  16, 539, 102],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [ 10,   0,  10,   8,  16,   5,   1, 172,  10, 777]])),
[2024-06-19 18:44:33,892][flwr][INFO] - 	                      (2,
[2024-06-19 18:44:33,892][flwr][INFO] - 	                       array([[ 932,    0,    5,    2,    0,    4,   32,    1,    4,    0],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   0, 1072,   24,    3,    0,    0,    3,    0,   32,    1],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  11,    5,  915,    6,   10,    0,   38,   12,   32,    3],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   7,    3,   95,  792,    0,   30,    5,   19,   54,    5],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   0,    2,    5,    0,  828,    0,   51,    0,    8,   88],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  23,    8,   12,   50,   20,  653,   51,   10,   59,    6],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  15,    5,    5,    0,    5,    5,  922,    0,    1,    0],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   6,   17,   45,    0,    6,    0,    0,  889,    8,   57],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  10,    7,   34,   11,   11,   15,   20,    8,  846,   12],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  14,    6,    6,    5,   55,    4,    5,   35,   30,  849]])),
[2024-06-19 18:44:33,892][flwr][INFO] - 	                      (3,
[2024-06-19 18:44:33,892][flwr][INFO] - 	                       array([[ 952,    0,    0,    3,    0,   20,    3,    1,    1,    0],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   0, 1097,    2,    4,    1,    6,    3,    0,   22,    0],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  12,   20,  862,   41,   16,    5,   14,   19,   35,    8],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   3,    3,   21,  877,    0,   56,    0,   21,   15,   14],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   1,    2,    7,    0,  870,    8,   11,    0,    7,   76],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   8,    3,    6,   36,    7,  791,    4,   12,   18,    7],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  32,    8,   10,    0,   24,   39,  843,    0,    2,    0],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   2,   20,   23,    2,    7,    1,    0,  927,    1,   45],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   6,    9,    9,   25,   13,   82,    6,   11,  776,   37],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  12,    6,    5,    6,   20,   16,    0,   28,    5,  911]])),
[2024-06-19 18:44:33,892][flwr][INFO] - 	                      (4,
[2024-06-19 18:44:33,892][flwr][INFO] - 	                       array([[ 961,    0,    1,    1,    0,    9,    4,    2,    2,    0],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   0, 1109,    6,    3,    1,    0,    3,    2,   11,    0],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  11,    7,  900,   22,   17,    2,   13,   19,   31,   10],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   4,    2,   22,  904,    1,   33,    2,   17,   16,    9],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   1,    0,    5,    0,  864,    1,   12,    0,    7,   92],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  16,    3,    6,   42,   16,  742,    9,   20,   25,   13],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [  24,    4,    9,    0,   23,   13,  883,    0,    2,    0],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   1,   10,   22,    4,    8,    0,    0,  933,    2,   48],
[2024-06-19 18:44:33,892][flwr][INFO] - 	       [   7,    9,   11,   36,   14,   26,   10,    8,  825,   28],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  11,    6,    0,   10,   32,    4,    0,   19,    7,  920]])),
[2024-06-19 18:44:33,893][flwr][INFO] - 	                      (5,
[2024-06-19 18:44:33,893][flwr][INFO] - 	                       array([[ 953,    0,    1,    3,    0,    8,   10,    1,    4,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   0, 1106,    1,    3,    1,    1,    4,    0,   19,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  10,   17,  889,   26,   18,    1,   15,   16,   34,    6],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   1,    6,   15,  904,    1,   36,    1,   13,   25,    8],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   1,    1,    5,    0,  929,    2,   11,    0,    9,   24],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   6,    4,    1,   35,    6,  778,   15,    5,   37,    5],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  17,    6,    4,    0,   14,   10,  903,    0,    4,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   1,   24,   20,    6,   12,    0,    0,  906,    4,   55],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   5,    8,    6,   17,   10,   18,    6,    4,  887,   13],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  12,    8,    0,   10,   62,    6,    0,    7,   10,  894]])),
[2024-06-19 18:44:33,893][flwr][INFO] - 	                      (6,
[2024-06-19 18:44:33,893][flwr][INFO] - 	                       array([[ 960,    0,    0,    0,    0,    6,    7,    2,    5,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   0, 1103,    1,    4,    1,    0,    4,    1,   21,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  15,    7,  876,    8,   12,    5,   14,   21,   68,    6],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   5,    2,   20,  828,    0,   82,    3,   15,   47,    8],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   0,    1,    5,    0,  825,    2,   14,    2,   12,  121],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   7,    2,    0,    8,    4,  812,   12,    7,   35,    5],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  14,    3,    2,    0,    9,   19,  899,    0,   12,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   2,   14,   17,    6,    4,    0,    0,  949,    2,   34],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   5,    2,    1,    9,    5,   19,    7,    7,  910,    9],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  11,    5,    0,    4,   16,   14,    0,   18,   20,  921]])),
[2024-06-19 18:44:33,893][flwr][INFO] - 	                      (7,
[2024-06-19 18:44:33,893][flwr][INFO] - 	                       array([[ 961,    0,    0,    0,    1,   10,    4,    1,    3,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   0, 1122,    1,    3,    1,    2,    4,    1,    1,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  11,   16,  925,   15,   14,    8,   11,   12,   19,    1],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   4,    7,   16,  912,    0,   33,    1,   14,   13,   10],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   2,    2,    5,    0,  932,    1,    9,    1,    2,   28],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   7,    1,    1,   25,    8,  814,    8,    6,   16,    6],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  20,    4,    2,    0,   14,   35,  879,    0,    4,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   1,   23,   31,    4,   10,    1,    0,  929,    0,   29],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   4,   32,    6,   24,   28,   59,    8,    8,  783,   22],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   5,    8,    0,   10,   84,   10,    0,   10,    6,  876]])),
[2024-06-19 18:44:33,893][flwr][INFO] - 	                      (8,
[2024-06-19 18:44:33,893][flwr][INFO] - 	                       array([[ 959,    0,    2,    1,    0,    9,    3,    1,    3,    2],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   0, 1113,    1,    4,    1,    1,    4,    0,   11,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  10,    5,  943,   23,    9,    0,    7,    7,   24,    4],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   1,    3,   12,  944,    0,   13,    3,    8,   17,    9],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   2,    1,    7,    0,  892,    3,    7,    0,    4,   66],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   9,    3,    1,   67,    3,  770,    9,    3,   20,    7],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [  10,    5,    4,    1,   15,   23,  892,    0,    8,    0],
[2024-06-19 18:44:33,893][flwr][INFO] - 	       [   1,   14,   23,   12,    5,    0,    0,  893,    0,   80],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   4,    7,    7,   26,   15,   21,    3,    3,  874,   14],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   7,    7,    0,    8,   28,    5,    0,    3,    9,  942]])),
[2024-06-19 18:44:33,894][flwr][INFO] - 	                      (9,
[2024-06-19 18:44:33,894][flwr][INFO] - 	                       array([[ 968,    0,    0,    0,    0,    4,    3,    1,    3,    1],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   0, 1112,    0,    4,    1,    1,    4,    0,   13,    0],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [  19,    5,  914,   19,   16,    5,    5,   17,   27,    5],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   6,    3,    7,  899,    1,   47,    1,   12,   23,   11],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   2,    2,    4,    0,  913,    2,    8,    0,    3,   48],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [  12,    1,    0,    8,    8,  831,    6,    4,   13,    9],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [  21,    3,    1,    0,   21,   22,  885,    0,    5,    0],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   3,   14,   18,    7,    8,    0,    0,  933,    2,   43],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   7,    2,    3,   13,   10,   35,    2,    4,  884,   14],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [  10,    9,    0,    5,   37,   12,    0,    5,    7,  924]])),
[2024-06-19 18:44:33,894][flwr][INFO] - 	                      (10,
[2024-06-19 18:44:33,894][flwr][INFO] - 	                       array([[ 970,    0,    0,    0,    0,    3,    1,    2,    3,    1],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   0, 1121,    1,    3,    1,    0,    3,    0,    6,    0],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   9,    6,  956,    6,    4,    2,    6,   20,   19,    4],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   3,    5,   15,  924,    0,   22,    0,   11,   20,   10],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   4,    3,    6,    0,  836,    0,    9,    1,    9,  114],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   7,    2,    2,   15,    1,  812,    7,    9,   30,    7],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [  14,    4,    3,    0,   10,   24,  893,    0,   10,    0],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   1,   12,   19,    6,    3,    0,    0,  951,    0,   36],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   5,    4,    3,   16,    6,   10,    2,    6,  899,   23],
[2024-06-19 18:44:33,894][flwr][INFO] - 	       [   8,    9,    0,    7,   10,    5,    0,    9,   14,  947]]))],
[2024-06-19 18:44:33,894][flwr][INFO] - 	 'f1': [(0, 0.03553137346181725),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (1, 0.7243643260043434),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (2, 0.8693508388259786),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (3, 0.890665420873969),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (4, 0.903928115805412),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (5, 0.9147236609505935),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (6, 0.9084561810789009),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (7, 0.9129627188062602),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (8, 0.9223250631529212),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (9, 0.9263716290140819),
[2024-06-19 18:44:33,894][flwr][INFO] - 	        (10, 0.9310128711920461)],
[2024-06-19 18:44:33,894][flwr][INFO] - 	 'precision': [(0, 0.12349967530374152),
[2024-06-19 18:44:33,894][flwr][INFO] - 	               (1, 0.7713849079857922),
[2024-06-19 18:44:33,894][flwr][INFO] - 	               (2, 0.874035973970096),
[2024-06-19 18:44:33,894][flwr][INFO] - 	               (3, 0.8929716806815703),
[2024-06-19 18:44:33,894][flwr][INFO] - 	               (4, 0.904832492962444),
[2024-06-19 18:44:33,894][flwr][INFO] - 	               (5, 0.9157514722238839),
[2024-06-19 18:44:33,894][flwr][INFO] - 	               (6, 0.9123994427850752),
[2024-06-19 18:44:33,894][flwr][INFO] - 	               (7, 0.9148736594032169),
[2024-06-19 18:44:33,895][flwr][INFO] - 	               (8, 0.9240811053523681),
[2024-06-19 18:44:33,895][flwr][INFO] - 	               (9, 0.9277417324177557),
[2024-06-19 18:44:33,895][flwr][INFO] - 	               (10, 0.9328074574556285)],
[2024-06-19 18:44:33,895][flwr][INFO] - 	 'recall': [(0, 0.1086),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (1, 0.7277),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (2, 0.8698),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (3, 0.8906),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (4, 0.9041),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (5, 0.9149),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (6, 0.9083),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (7, 0.9133),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (8, 0.9222),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (9, 0.9263),
[2024-06-19 18:44:33,895][flwr][INFO] - 	            (10, 0.9309)]}
[2024-06-19 18:44:33,895][flwr][INFO] - 
