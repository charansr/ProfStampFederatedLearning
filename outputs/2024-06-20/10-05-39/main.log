[2024-06-20 10:05:39,268][flwr][INFO] - Starting Flower simulation, config: num_rounds=10, no round_timeout
[2024-06-20 10:05:41,335][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 8430007092.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 12.0}
[2024-06-20 10:05:41,336][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-06-20 10:05:41,336][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 2, 'num_gpus': 0}
[2024-06-20 10:05:41,347][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 6 actors
[2024-06-20 10:05:41,347][flwr][INFO] - [INIT]
[2024-06-20 10:05:41,347][flwr][INFO] - Requesting initial parameters from one random client
[2024-06-20 10:05:43,296][flwr][INFO] - Received initial parameters from one random client
[2024-06-20 10:05:43,296][flwr][INFO] - Evaluating initial global parameters
[2024-06-20 10:05:43,751][flwr][INFO] - initial parameters (loss, other metrics): 181.76928067207336, {'accuracy': 0.1086, 'precision': 0.12349967530374152, 'recall': 0.1086, 'f1': 0.03553137346181725, 'confusion_matrix': array([[   0,    8,    0,  956,    0,    1,    0,   15,    0,    0],
       [   0,  122,    0, 1013,    0,    0,    0,    0,    0,    0],
       [   0,   38,    0,  971,    0,    0,    3,   19,    1,    0],
       [   0,   44,    0,  945,    1,    1,    0,   17,    2,    0],
       [   0,  143,    0,  816,    1,    0,    2,   20,    0,    0],
       [   0,  118,    0,  735,    1,    7,    0,   30,    1,    0],
       [   0,  144,    0,  749,   25,    0,    2,   38,    0,    0],
       [   0,  272,    0,  724,    8,    0,    0,    9,   15,    0],
       [   0,   81,    0,  859,    1,    0,    1,   32,    0,    0],
       [   0,  178,    0,  799,    1,    0,    0,   31,    0,    0]])}
[2024-06-20 10:05:43,752][flwr][INFO] - 
[2024-06-20 10:05:43,752][flwr][INFO] - [ROUND 1]
[2024-06-20 10:05:43,752][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-20 10:05:50,916][flwr][INFO] - aggregate_fit: received 10 results and 0 failures
[2024-06-20 10:05:50,923][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-06-20 10:05:51,369][flwr][INFO] - fit progress: (1, 386.16464751958847, {'accuracy': 0.7672, 'precision': 0.7970345852166191, 'recall': 0.7672, 'f1': 0.757210461695805, 'confusion_matrix': array([[ 860,    0,   22,    1,    0,    2,   77,    9,    9,    0],
       [   0, 1092,   18,    1,    0,    0,    3,    0,   21,    0],
       [  11,   12,  903,   10,    9,    0,   34,   17,   28,    8],
       [   5,   20,  137,  610,    0,   15,   11,   30,  174,    8],
       [   0,   11,   10,    0,  420,    0,   37,    6,   10,  488],
       [  25,   40,   40,   55,   29,  349,   64,   30,  232,   28],
       [   4,   10,   16,    0,    8,    4,  912,    0,    3,    1],
       [   1,   26,   29,    0,    5,    0,    2,  919,    4,   42],
       [  14,   20,   65,   10,    3,   12,   24,   22,  741,   63],
       [  12,   15,    9,    1,   14,    0,    3,   64,   25,  866]])}, 7.617503292)
[2024-06-20 10:05:51,370][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-20 10:05:51,370][flwr][INFO] - 
[2024-06-20 10:05:51,370][flwr][INFO] - [ROUND 2]
[2024-06-20 10:05:51,370][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-20 10:05:58,474][flwr][INFO] - aggregate_fit: received 10 results and 0 failures
[2024-06-20 10:05:58,967][flwr][INFO] - fit progress: (2, 3446.643840789795, {'accuracy': 0.8711, 'precision': 0.8710916017062369, 'recall': 0.8711, 'f1': 0.8699605015151661, 'confusion_matrix': array([[ 954,    0,    2,    2,    0,    5,   13,    1,    3,    0],
       [   0, 1088,   13,    3,    2,    5,    4,    0,   20,    0],
       [  20,    5,  862,   23,   17,    4,   33,   19,   40,    9],
       [  15,    3,   34,  821,    0,   41,    7,   34,   45,   10],
       [   3,    2,    6,    0,  903,    1,   26,    1,    2,   38],
       [  32,    7,   12,   48,   28,  682,   28,   16,   29,   10],
       [  20,    3,    3,    1,   17,   13,  900,    0,    1,    0],
       [   1,   14,   24,    3,   18,    0,    0,  924,    3,   41],
       [  17,   10,   21,   34,   15,   40,   17,   19,  756,   45],
       [  17,    6,    6,    2,  102,    5,    1,   37,   12,  821]])}, 15.216149792000001)
[2024-06-20 10:05:58,968][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-20 10:05:58,968][flwr][INFO] - 
[2024-06-20 10:05:58,968][flwr][INFO] - [ROUND 3]
[2024-06-20 10:05:58,969][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-20 10:06:07,481][flwr][INFO] - aggregate_fit: received 10 results and 0 failures
[2024-06-20 10:06:08,302][flwr][INFO] - fit progress: (3, 71661.2680053711, {'accuracy': 0.879, 'precision': 0.8797268211525224, 'recall': 0.879, 'f1': 0.8789644185709982, 'confusion_matrix': array([[ 939,    0,    2,    5,    1,   19,    6,    2,    6,    0],
       [   0, 1083,   10,    3,    0,    8,    3,    0,   28,    0],
       [  15,    5,  841,   40,   18,    7,   24,   17,   57,    8],
       [   5,    2,   20,  860,    0,   44,    2,   22,   47,    8],
       [   1,    5,    7,    0,  887,    6,   17,    1,   11,   47],
       [  11,    5,    7,   43,   15,  741,   15,   13,   33,    9],
       [  22,    4,    7,    1,   19,   26,  875,    0,    4,    0],
       [   1,   16,   22,    5,   12,    0,    0,  924,    6,   42],
       [   8,    4,   12,   35,   10,   58,   11,   13,  800,   23],
       [  11,    8,    3,    5,   76,   11,    1,   34,   20,  840]])}, 24.551282667000002)
[2024-06-20 10:06:08,304][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-20 10:06:08,305][flwr][INFO] - 
[2024-06-20 10:06:08,305][flwr][INFO] - [ROUND 4]
[2024-06-20 10:06:08,307][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-20 10:06:15,856][flwr][INFO] - aggregate_fit: received 10 results and 0 failures
[2024-06-20 10:06:16,300][flwr][INFO] - fit progress: (4, 1786142.0061035156, {'accuracy': 0.881, 'precision': 0.8813792849174331, 'recall': 0.881, 'f1': 0.8808497751447839, 'confusion_matrix': array([[ 940,    0,    3,    8,    0,   12,   10,    2,    5,    0],
       [   0, 1082,   12,    5,    0,    4,    3,    0,   29,    0],
       [  15,    4,  862,   46,   17,    3,   20,   15,   43,    7],
       [   5,    2,   22,  878,    0,   33,    3,   20,   40,    7],
       [   1,    4,    8,    0,  886,    4,   19,    1,   11,   48],
       [  12,    5,    8,   62,   16,  707,   17,   13,   42,   10],
       [  16,    2,    7,    1,   18,   23,  887,    0,    4,    0],
       [   1,   14,   27,    8,   11,    0,    0,  922,    4,   41],
       [   7,    3,   14,   55,    9,   43,   11,   13,  799,   20],
       [  11,    7,    4,    8,   70,    8,    1,   34,   19,  847]])}, 32.549144500000004)
[2024-06-20 10:06:16,300][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-20 10:06:16,300][flwr][INFO] - 
[2024-06-20 10:06:16,300][flwr][INFO] - [ROUND 5]
[2024-06-20 10:06:16,301][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-20 10:06:22,476][flwr][INFO] - aggregate_fit: received 10 results and 0 failures
[2024-06-20 10:06:22,940][flwr][INFO] - fit progress: (5, 46977669.921875, {'accuracy': 0.8817, 'precision': 0.8818876767371505, 'recall': 0.8817, 'f1': 0.8815105360575534, 'confusion_matrix': array([[ 942,    0,    3,    7,    1,   12,    8,    2,    5,    0],
       [   0, 1084,   13,    3,    0,    4,    3,    0,   27,    1],
       [  15,    4,  864,   43,   17,    4,   20,   15,   42,    8],
       [   5,    2,   24,  875,    0,   33,    3,   20,   40,    8],
       [   1,    4,    8,    0,  889,    3,   16,    1,   10,   50],
       [  12,    5,    8,   59,   16,  704,   17,   15,   45,   11],
       [  16,    3,    7,    1,   19,   24,  884,    0,    4,    0],
       [   1,   15,   27,    5,   11,    0,    0,  920,    5,   44],
       [   7,    4,   14,   50,    9,   41,   11,   13,  800,   25],
       [  11,    7,    4,    7,   65,    7,    1,   31,   21,  855]])}, 39.189570583)
[2024-06-20 10:06:22,941][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-20 10:06:22,941][flwr][INFO] - 
[2024-06-20 10:06:22,941][flwr][INFO] - [ROUND 6]
[2024-06-20 10:06:22,941][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-20 10:06:28,707][flwr][INFO] - aggregate_fit: received 10 results and 0 failures
[2024-06-20 10:06:29,162][flwr][INFO] - fit progress: (6, 1258415851.5, {'accuracy': 0.8813, 'precision': 0.8813883219251313, 'recall': 0.8813, 'f1': 0.8810665210378819, 'confusion_matrix': array([[ 942,    0,    3,    7,    1,   12,    8,    2,    5,    0],
       [   0, 1084,   13,    4,    0,    4,    3,    0,   26,    1],
       [  15,    4,  865,   43,   17,    4,   20,   15,   41,    8],
       [   5,    2,   24,  878,    0,   33,    3,   20,   37,    8],
       [   1,    6,    8,    0,  888,    3,   15,    1,   10,   50],
       [  13,    5,    9,   61,   16,  706,   15,   15,   41,   11],
       [  17,    4,    7,    1,   19,   24,  883,    0,    3,    0],
       [   1,   14,   28,    7,    9,    0,    0,  923,    4,   42],
       [   7,    5,   14,   57,   11,   43,   11,   13,  788,   25],
       [  11,    7,    4,    8,   64,    7,    1,   31,   20,  856]])}, 45.411823792)
[2024-06-20 10:06:29,163][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2024-06-20 10:06:29,163][flwr][INFO] - 
[2024-06-20 10:06:29,163][flwr][INFO] - [ROUND 7]
[2024-06-20 10:06:29,163][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 100)
[2024-06-20 10:06:31,835][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TaskCancelledError): [36mray::ClientAppActor.run()[39m (pid=95472, ip=127.0.0.1, actor_id=e2376e70272a3f227138acc301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x119b7fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 44, in train
    for images, labels in trainloader:
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1318, in _next_data
    self._shutdown_workers()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
ray.exceptions.TaskCancelledError: Task: TaskID(0a34c32cdb9fb20de2376e70272a3f227138acc301000000) was cancelled.

[2024-06-20 10:06:31,861][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=95472, ip=127.0.0.1, actor_id=e2376e70272a3f227138acc301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x119b7fa60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 44, in train
    for images, labels in trainloader:
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1318, in _next_data
    self._shutdown_workers()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
ray.exceptions.TaskCancelledError: Task: TaskID(0a34c32cdb9fb20de2376e70272a3f227138acc301000000) was cancelled.
[2024-06-20 10:06:31,866][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TaskCancelledError): [36mray::ClientAppActor.run()[39m (pid=95471, ip=127.0.0.1, actor_id=6522541fb014d48c45cf4df901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x134a17a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 44, in train
    for images, labels in trainloader:
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1318, in _next_data
    self._shutdown_workers()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
ray.exceptions.TaskCancelledError: Task: TaskID(743b0b01d46488736522541fb014d48c45cf4df901000000) was cancelled.

[2024-06-20 10:06:31,876][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=95471, ip=127.0.0.1, actor_id=6522541fb014d48c45cf4df901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x134a17a90>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 44, in train
    for images, labels in trainloader:
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1318, in _next_data
    self._shutdown_workers()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
ray.exceptions.TaskCancelledError: Task: TaskID(743b0b01d46488736522541fb014d48c45cf4df901000000) was cancelled.
[2024-06-20 10:06:32,302][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TaskCancelledError): [36mray::ClientAppActor.run()[39m (pid=95469, ip=127.0.0.1, actor_id=3f924ba8d01af2664d0c80ed01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x11798aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 44, in train
    for images, labels in trainloader:
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1329, in _next_data
    idx, data = self._get_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1295, in _get_data
    success, data = self._try_get_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/queues.py", line 107, in get
    if not self._poll(timeout):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
ray.exceptions.TaskCancelledError: Task: TaskID(dfba745f8bb282ea3f924ba8d01af2664d0c80ed01000000) was cancelled.

[2024-06-20 10:06:32,305][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=95469, ip=127.0.0.1, actor_id=3f924ba8d01af2664d0c80ed01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x11798aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 44, in train
    for images, labels in trainloader:
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1329, in _next_data
    idx, data = self._get_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1295, in _get_data
    success, data = self._try_get_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/queues.py", line 107, in get
    if not self._poll(timeout):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
ray.exceptions.TaskCancelledError: Task: TaskID(dfba745f8bb282ea3f924ba8d01af2664d0c80ed01000000) was cancelled.
[2024-06-20 10:06:32,397][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TaskCancelledError): [36mray::ClientAppActor.run()[39m (pid=95473, ip=127.0.0.1, actor_id=5f97452479dc82bfe0793d6301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x115426ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 48, in train
    loss.backward()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
ray.exceptions.TaskCancelledError: Task: TaskID(baf24b1a745e8c055f97452479dc82bfe0793d6301000000) was cancelled.

[2024-06-20 10:06:32,398][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TaskCancelledError): [36mray::ClientAppActor.run()[39m (pid=95470, ip=127.0.0.1, actor_id=8347b06395f4e12bb60163df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x11678aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 47, in train
    loss = criterion(net(images), labels)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/charansr/Stamp2024/model.py", line 29, in forward
    x = self.relu1(self.fc1(x))
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 103, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/functional.py", line 1489, in relu
    def relu(input: Tensor, inplace: bool = False) -> Tensor:  # noqa: D400,D402
ray.exceptions.TaskCancelledError: Task: TaskID(d9aee7ad319b76638347b06395f4e12bb60163df01000000) was cancelled.

[2024-06-20 10:06:32,398][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=95473, ip=127.0.0.1, actor_id=5f97452479dc82bfe0793d6301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x115426ac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 48, in train
    loss.backward()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
ray.exceptions.TaskCancelledError: Task: TaskID(baf24b1a745e8c055f97452479dc82bfe0793d6301000000) was cancelled.
[2024-06-20 10:06:32,398][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=95470, ip=127.0.0.1, actor_id=8347b06395f4e12bb60163df01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x11678aac0>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 47, in train
    loss = criterion(net(images), labels)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/charansr/Stamp2024/model.py", line 29, in forward
    x = self.relu1(self.fc1(x))
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 103, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/nn/functional.py", line 1489, in relu
    def relu(input: Tensor, inplace: bool = False) -> Tensor:  # noqa: D400,D402
ray.exceptions.TaskCancelledError: Task: TaskID(d9aee7ad319b76638347b06395f4e12bb60163df01000000) was cancelled.
[2024-06-20 10:06:32,414][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TaskCancelledError): [36mray::ClientAppActor.run()[39m (pid=95468, ip=127.0.0.1, actor_id=320ae03f9166261f1cd2342d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109b97a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 44, in train
    for images, labels in trainloader:
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1329, in _next_data
    idx, data = self._get_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1295, in _get_data
    success, data = self._try_get_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 514, in rebuild_storage_filename
    storage = torch.UntypedStorage._new_shared_filename_cpu(manager, handle, size)
ray.exceptions.TaskCancelledError: Task: TaskID(466e126b3836936b320ae03f9166261f1cd2342d01000000) was cancelled.

[2024-06-20 10:06:32,415][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=95468, ip=127.0.0.1, actor_id=320ae03f9166261f1cd2342d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109b97a60>)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/Users/charansr/Stamp2024/client.py", line 124, in fit
    train(self.model, trainloader, optim, epochs, self.device)
  File "/Users/charansr/Stamp2024/model.py", line 44, in train
    for images, labels in trainloader:
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1329, in _next_data
    idx, data = self._get_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1295, in _get_data
    success, data = self._try_get_data()
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/opt/anaconda3/envs/flwr_env/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 514, in rebuild_storage_filename
    storage = torch.UntypedStorage._new_shared_filename_cpu(manager, handle, size)
ray.exceptions.TaskCancelledError: Task: TaskID(466e126b3836936b320ae03f9166261f1cd2342d01000000) was cancelled.
